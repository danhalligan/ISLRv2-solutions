<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Linear Model Selection and Regularization | An Introduction to Statistical Learning</title>
  <meta name="description" content="6 Linear Model Selection and Regularization | An Introduction to Statistical Learning" />
  <meta name="generator" content="bookdown 0.29.3 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Linear Model Selection and Regularization | An Introduction to Statistical Learning" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Linear Model Selection and Regularization | An Introduction to Statistical Learning" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="resampling-methods.html"/>
<link rel="next" href="moving-beyond-linearity.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="islrv2.css" type="text/css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/aaaakshat/cm-web-fonts@latest/fonts.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ISLRv2 Solutions</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="statistical-learning.html"><a href="statistical-learning.html"><i class="fa fa-check"></i><b>2</b> Statistical Learning</a><ul>
<li class="chapter" data-level="2.1" data-path="statistical-learning.html"><a href="statistical-learning.html#conceptual"><i class="fa fa-check"></i><b>2.1</b> Conceptual</a><ul>
<li class="chapter" data-level="2.1.1" data-path="statistical-learning.html"><a href="statistical-learning.html#question-1"><i class="fa fa-check"></i><b>2.1.1</b> Question 1</a></li>
<li class="chapter" data-level="2.1.2" data-path="statistical-learning.html"><a href="statistical-learning.html#question-2"><i class="fa fa-check"></i><b>2.1.2</b> Question 2</a></li>
<li class="chapter" data-level="2.1.3" data-path="statistical-learning.html"><a href="statistical-learning.html#question-3"><i class="fa fa-check"></i><b>2.1.3</b> Question 3</a></li>
<li class="chapter" data-level="2.1.4" data-path="statistical-learning.html"><a href="statistical-learning.html#question-4"><i class="fa fa-check"></i><b>2.1.4</b> Question 4</a></li>
<li class="chapter" data-level="2.1.5" data-path="statistical-learning.html"><a href="statistical-learning.html#question-5"><i class="fa fa-check"></i><b>2.1.5</b> Question 5</a></li>
<li class="chapter" data-level="2.1.6" data-path="statistical-learning.html"><a href="statistical-learning.html#question-6"><i class="fa fa-check"></i><b>2.1.6</b> Question 6</a></li>
<li class="chapter" data-level="2.1.7" data-path="statistical-learning.html"><a href="statistical-learning.html#question-7"><i class="fa fa-check"></i><b>2.1.7</b> Question 7</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="statistical-learning.html"><a href="statistical-learning.html#applied"><i class="fa fa-check"></i><b>2.2</b> Applied</a><ul>
<li class="chapter" data-level="2.2.1" data-path="statistical-learning.html"><a href="statistical-learning.html#question-8"><i class="fa fa-check"></i><b>2.2.1</b> Question 8</a></li>
<li class="chapter" data-level="2.2.2" data-path="statistical-learning.html"><a href="statistical-learning.html#question-9"><i class="fa fa-check"></i><b>2.2.2</b> Question 9</a></li>
<li class="chapter" data-level="2.2.3" data-path="statistical-learning.html"><a href="statistical-learning.html#question-10"><i class="fa fa-check"></i><b>2.2.3</b> Question 10</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>3</b> Linear Regression</a><ul>
<li class="chapter" data-level="3.1" data-path="linear-regression.html"><a href="linear-regression.html#conceptual-1"><i class="fa fa-check"></i><b>3.1</b> Conceptual</a><ul>
<li class="chapter" data-level="3.1.1" data-path="linear-regression.html"><a href="linear-regression.html#question-1-1"><i class="fa fa-check"></i><b>3.1.1</b> Question 1</a></li>
<li class="chapter" data-level="3.1.2" data-path="linear-regression.html"><a href="linear-regression.html#question-2-1"><i class="fa fa-check"></i><b>3.1.2</b> Question 2</a></li>
<li class="chapter" data-level="3.1.3" data-path="linear-regression.html"><a href="linear-regression.html#question-3-1"><i class="fa fa-check"></i><b>3.1.3</b> Question 3</a></li>
<li class="chapter" data-level="3.1.4" data-path="linear-regression.html"><a href="linear-regression.html#question-4-1"><i class="fa fa-check"></i><b>3.1.4</b> Question 4</a></li>
<li class="chapter" data-level="3.1.5" data-path="linear-regression.html"><a href="linear-regression.html#question-5-1"><i class="fa fa-check"></i><b>3.1.5</b> Question 5</a></li>
<li class="chapter" data-level="3.1.6" data-path="linear-regression.html"><a href="linear-regression.html#question-6-1"><i class="fa fa-check"></i><b>3.1.6</b> Question 6</a></li>
<li class="chapter" data-level="3.1.7" data-path="linear-regression.html"><a href="linear-regression.html#question-7-1"><i class="fa fa-check"></i><b>3.1.7</b> Question 7</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="linear-regression.html"><a href="linear-regression.html#applied-1"><i class="fa fa-check"></i><b>3.2</b> Applied</a><ul>
<li class="chapter" data-level="3.2.1" data-path="linear-regression.html"><a href="linear-regression.html#question-8-1"><i class="fa fa-check"></i><b>3.2.1</b> Question 8</a></li>
<li class="chapter" data-level="3.2.2" data-path="linear-regression.html"><a href="linear-regression.html#question-9-1"><i class="fa fa-check"></i><b>3.2.2</b> Question 9</a></li>
<li class="chapter" data-level="3.2.3" data-path="linear-regression.html"><a href="linear-regression.html#question-10-1"><i class="fa fa-check"></i><b>3.2.3</b> Question 10</a></li>
<li class="chapter" data-level="3.2.4" data-path="linear-regression.html"><a href="linear-regression.html#question-11"><i class="fa fa-check"></i><b>3.2.4</b> Question 11</a></li>
<li class="chapter" data-level="3.2.5" data-path="linear-regression.html"><a href="linear-regression.html#question-12"><i class="fa fa-check"></i><b>3.2.5</b> Question 12</a></li>
<li class="chapter" data-level="3.2.6" data-path="linear-regression.html"><a href="linear-regression.html#question-13"><i class="fa fa-check"></i><b>3.2.6</b> Question 13</a></li>
<li class="chapter" data-level="3.2.7" data-path="linear-regression.html"><a href="linear-regression.html#question-14"><i class="fa fa-check"></i><b>3.2.7</b> Question 14</a></li>
<li class="chapter" data-level="3.2.8" data-path="linear-regression.html"><a href="linear-regression.html#question-15"><i class="fa fa-check"></i><b>3.2.8</b> Question 15</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>4</b> Classification</a><ul>
<li class="chapter" data-level="4.1" data-path="classification.html"><a href="classification.html#conceptual-2"><i class="fa fa-check"></i><b>4.1</b> Conceptual</a><ul>
<li class="chapter" data-level="4.1.1" data-path="classification.html"><a href="classification.html#question-1-2"><i class="fa fa-check"></i><b>4.1.1</b> Question 1</a></li>
<li class="chapter" data-level="4.1.2" data-path="classification.html"><a href="classification.html#question-2-2"><i class="fa fa-check"></i><b>4.1.2</b> Question 2</a></li>
<li class="chapter" data-level="4.1.3" data-path="classification.html"><a href="classification.html#question-3-2"><i class="fa fa-check"></i><b>4.1.3</b> Question 3</a></li>
<li class="chapter" data-level="4.1.4" data-path="classification.html"><a href="classification.html#question-4-2"><i class="fa fa-check"></i><b>4.1.4</b> Question 4</a></li>
<li class="chapter" data-level="4.1.5" data-path="classification.html"><a href="classification.html#question-5-2"><i class="fa fa-check"></i><b>4.1.5</b> Question 5</a></li>
<li class="chapter" data-level="4.1.6" data-path="classification.html"><a href="classification.html#question-6-2"><i class="fa fa-check"></i><b>4.1.6</b> Question 6</a></li>
<li class="chapter" data-level="4.1.7" data-path="classification.html"><a href="classification.html#question-7-2"><i class="fa fa-check"></i><b>4.1.7</b> Question 7</a></li>
<li class="chapter" data-level="4.1.8" data-path="classification.html"><a href="classification.html#question-8-2"><i class="fa fa-check"></i><b>4.1.8</b> Question 8</a></li>
<li class="chapter" data-level="4.1.9" data-path="classification.html"><a href="classification.html#question-9-2"><i class="fa fa-check"></i><b>4.1.9</b> Question 9</a></li>
<li class="chapter" data-level="4.1.10" data-path="classification.html"><a href="classification.html#question-10-2"><i class="fa fa-check"></i><b>4.1.10</b> Question 10</a></li>
<li class="chapter" data-level="4.1.11" data-path="classification.html"><a href="classification.html#question-11-1"><i class="fa fa-check"></i><b>4.1.11</b> Question 11</a></li>
<li class="chapter" data-level="4.1.12" data-path="classification.html"><a href="classification.html#question-12-1"><i class="fa fa-check"></i><b>4.1.12</b> Question 12</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="classification.html"><a href="classification.html#applied-2"><i class="fa fa-check"></i><b>4.2</b> Applied</a><ul>
<li class="chapter" data-level="4.2.1" data-path="classification.html"><a href="classification.html#question-13-1"><i class="fa fa-check"></i><b>4.2.1</b> Question 13</a></li>
<li class="chapter" data-level="4.2.2" data-path="classification.html"><a href="classification.html#question-14-1"><i class="fa fa-check"></i><b>4.2.2</b> Question 14</a></li>
<li class="chapter" data-level="4.2.3" data-path="classification.html"><a href="classification.html#question-15-1"><i class="fa fa-check"></i><b>4.2.3</b> Question 15</a></li>
<li class="chapter" data-level="4.2.4" data-path="classification.html"><a href="classification.html#question-13-2"><i class="fa fa-check"></i><b>4.2.4</b> Question 13</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="resampling-methods.html"><a href="resampling-methods.html"><i class="fa fa-check"></i><b>5</b> Resampling Methods</a><ul>
<li class="chapter" data-level="5.1" data-path="resampling-methods.html"><a href="resampling-methods.html#conceptual-3"><i class="fa fa-check"></i><b>5.1</b> Conceptual</a><ul>
<li class="chapter" data-level="5.1.1" data-path="resampling-methods.html"><a href="resampling-methods.html#question-1-3"><i class="fa fa-check"></i><b>5.1.1</b> Question 1</a></li>
<li class="chapter" data-level="5.1.2" data-path="resampling-methods.html"><a href="resampling-methods.html#question-2-3"><i class="fa fa-check"></i><b>5.1.2</b> Question 2</a></li>
<li class="chapter" data-level="5.1.3" data-path="resampling-methods.html"><a href="resampling-methods.html#question-3-3"><i class="fa fa-check"></i><b>5.1.3</b> Question 3</a></li>
<li class="chapter" data-level="5.1.4" data-path="resampling-methods.html"><a href="resampling-methods.html#question-4-3"><i class="fa fa-check"></i><b>5.1.4</b> Question 4</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="resampling-methods.html"><a href="resampling-methods.html#applied-3"><i class="fa fa-check"></i><b>5.2</b> Applied</a><ul>
<li class="chapter" data-level="5.2.1" data-path="resampling-methods.html"><a href="resampling-methods.html#question-5-3"><i class="fa fa-check"></i><b>5.2.1</b> Question 5</a></li>
<li class="chapter" data-level="5.2.2" data-path="resampling-methods.html"><a href="resampling-methods.html#question-6-3"><i class="fa fa-check"></i><b>5.2.2</b> Question 6</a></li>
<li class="chapter" data-level="5.2.3" data-path="resampling-methods.html"><a href="resampling-methods.html#question-7-3"><i class="fa fa-check"></i><b>5.2.3</b> Question 7</a></li>
<li class="chapter" data-level="5.2.4" data-path="resampling-methods.html"><a href="resampling-methods.html#question-8-3"><i class="fa fa-check"></i><b>5.2.4</b> Question 8</a></li>
<li class="chapter" data-level="5.2.5" data-path="resampling-methods.html"><a href="resampling-methods.html#question-9-3"><i class="fa fa-check"></i><b>5.2.5</b> Question 9</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html"><i class="fa fa-check"></i><b>6</b> Linear Model Selection and Regularization</a><ul>
<li class="chapter" data-level="6.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#conceptual-4"><i class="fa fa-check"></i><b>6.1</b> Conceptual</a><ul>
<li class="chapter" data-level="6.1.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-1-4"><i class="fa fa-check"></i><b>6.1.1</b> Question 1</a></li>
<li class="chapter" data-level="6.1.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-2-4"><i class="fa fa-check"></i><b>6.1.2</b> Question 2</a></li>
<li class="chapter" data-level="6.1.3" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-3-4"><i class="fa fa-check"></i><b>6.1.3</b> Question 3</a></li>
<li class="chapter" data-level="6.1.4" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-4-4"><i class="fa fa-check"></i><b>6.1.4</b> Question 4</a></li>
<li class="chapter" data-level="6.1.5" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-5-4"><i class="fa fa-check"></i><b>6.1.5</b> Question 5</a></li>
<li class="chapter" data-level="6.1.6" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-6-4"><i class="fa fa-check"></i><b>6.1.6</b> Question 6</a></li>
<li class="chapter" data-level="6.1.7" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-7-4"><i class="fa fa-check"></i><b>6.1.7</b> Question 7</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#applied-4"><i class="fa fa-check"></i><b>6.2</b> Applied</a><ul>
<li class="chapter" data-level="6.2.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-8-4"><i class="fa fa-check"></i><b>6.2.1</b> Question 8</a></li>
<li class="chapter" data-level="6.2.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-9-4"><i class="fa fa-check"></i><b>6.2.2</b> Question 9</a></li>
<li class="chapter" data-level="6.2.3" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-10-3"><i class="fa fa-check"></i><b>6.2.3</b> Question 10</a></li>
<li class="chapter" data-level="6.2.4" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#question-11-2"><i class="fa fa-check"></i><b>6.2.4</b> Question 11</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html"><i class="fa fa-check"></i><b>7</b> Moving Beyond Linearity</a><ul>
<li class="chapter" data-level="7.1" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#conceptual-5"><i class="fa fa-check"></i><b>7.1</b> Conceptual</a><ul>
<li class="chapter" data-level="7.1.1" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-1-5"><i class="fa fa-check"></i><b>7.1.1</b> Question 1</a></li>
<li class="chapter" data-level="7.1.2" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-2-5"><i class="fa fa-check"></i><b>7.1.2</b> Question 2</a></li>
<li class="chapter" data-level="7.1.3" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-3-5"><i class="fa fa-check"></i><b>7.1.3</b> Question 3</a></li>
<li class="chapter" data-level="7.1.4" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-4-5"><i class="fa fa-check"></i><b>7.1.4</b> Question 4</a></li>
<li class="chapter" data-level="7.1.5" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-5-5"><i class="fa fa-check"></i><b>7.1.5</b> Question 5</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#applied-5"><i class="fa fa-check"></i><b>7.2</b> Applied</a><ul>
<li class="chapter" data-level="7.2.1" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-6-5"><i class="fa fa-check"></i><b>7.2.1</b> Question 6</a></li>
<li class="chapter" data-level="7.2.2" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-7-5"><i class="fa fa-check"></i><b>7.2.2</b> Question 7</a></li>
<li class="chapter" data-level="7.2.3" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-8-5"><i class="fa fa-check"></i><b>7.2.3</b> Question 8</a></li>
<li class="chapter" data-level="7.2.4" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-9-5"><i class="fa fa-check"></i><b>7.2.4</b> Question 9</a></li>
<li class="chapter" data-level="7.2.5" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-10-4"><i class="fa fa-check"></i><b>7.2.5</b> Question 10</a></li>
<li class="chapter" data-level="7.2.6" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-11-3"><i class="fa fa-check"></i><b>7.2.6</b> Question 11</a></li>
<li class="chapter" data-level="7.2.7" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#question-12-2"><i class="fa fa-check"></i><b>7.2.7</b> Question 12</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tree-based-methods.html"><a href="tree-based-methods.html"><i class="fa fa-check"></i><b>8</b> Tree-Based Methods</a><ul>
<li class="chapter" data-level="8.1" data-path="tree-based-methods.html"><a href="tree-based-methods.html#conceptual-6"><i class="fa fa-check"></i><b>8.1</b> Conceptual</a><ul>
<li class="chapter" data-level="8.1.1" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-1-6"><i class="fa fa-check"></i><b>8.1.1</b> Question 1</a></li>
<li class="chapter" data-level="8.1.2" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-2-6"><i class="fa fa-check"></i><b>8.1.2</b> Question 2</a></li>
<li class="chapter" data-level="8.1.3" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-3-6"><i class="fa fa-check"></i><b>8.1.3</b> Question 3</a></li>
<li class="chapter" data-level="8.1.4" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-4-6"><i class="fa fa-check"></i><b>8.1.4</b> Question 4</a></li>
<li class="chapter" data-level="8.1.5" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-5-6"><i class="fa fa-check"></i><b>8.1.5</b> Question 5</a></li>
<li class="chapter" data-level="8.1.6" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-6-6"><i class="fa fa-check"></i><b>8.1.6</b> Question 6</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="tree-based-methods.html"><a href="tree-based-methods.html#applied-6"><i class="fa fa-check"></i><b>8.2</b> Applied</a><ul>
<li class="chapter" data-level="8.2.1" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-7-6"><i class="fa fa-check"></i><b>8.2.1</b> Question 7</a></li>
<li class="chapter" data-level="8.2.2" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-8-6"><i class="fa fa-check"></i><b>8.2.2</b> Question 8</a></li>
<li class="chapter" data-level="8.2.3" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-9-6"><i class="fa fa-check"></i><b>8.2.3</b> Question 9</a></li>
<li class="chapter" data-level="8.2.4" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-10-5"><i class="fa fa-check"></i><b>8.2.4</b> Question 10</a></li>
<li class="chapter" data-level="8.2.5" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-11-4"><i class="fa fa-check"></i><b>8.2.5</b> Question 11</a></li>
<li class="chapter" data-level="8.2.6" data-path="tree-based-methods.html"><a href="tree-based-methods.html#question-12-3"><i class="fa fa-check"></i><b>8.2.6</b> Question 12</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="support-vector-machines.html"><a href="support-vector-machines.html"><i class="fa fa-check"></i><b>9</b> Support Vector Machines</a><ul>
<li class="chapter" data-level="9.1" data-path="support-vector-machines.html"><a href="support-vector-machines.html#conceptual-7"><i class="fa fa-check"></i><b>9.1</b> Conceptual</a><ul>
<li class="chapter" data-level="9.1.1" data-path="support-vector-machines.html"><a href="support-vector-machines.html#question-1-7"><i class="fa fa-check"></i><b>9.1.1</b> Question 1</a></li>
<li class="chapter" data-level="9.1.2" data-path="support-vector-machines.html"><a href="support-vector-machines.html#question-2-7"><i class="fa fa-check"></i><b>9.1.2</b> Question 2</a></li>
<li class="chapter" data-level="9.1.3" data-path="support-vector-machines.html"><a href="support-vector-machines.html#question-3-7"><i class="fa fa-check"></i><b>9.1.3</b> Question 3</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="support-vector-machines.html"><a href="support-vector-machines.html#applied-7"><i class="fa fa-check"></i><b>9.2</b> Applied</a><ul>
<li class="chapter" data-level="9.2.1" data-path="support-vector-machines.html"><a href="support-vector-machines.html#question-4-7"><i class="fa fa-check"></i><b>9.2.1</b> Question 4</a></li>
<li class="chapter" data-level="9.2.2" data-path="support-vector-machines.html"><a href="support-vector-machines.html#question-5-7"><i class="fa fa-check"></i><b>9.2.2</b> Question 5</a></li>
<li class="chapter" data-level="9.2.3" data-path="support-vector-machines.html"><a href="support-vector-machines.html#question-6-7"><i class="fa fa-check"></i><b>9.2.3</b> Question 6</a></li>
<li class="chapter" data-level="9.2.4" data-path="support-vector-machines.html"><a href="support-vector-machines.html#question-7-7"><i class="fa fa-check"></i><b>9.2.4</b> Question 7</a></li>
<li class="chapter" data-level="9.2.5" data-path="support-vector-machines.html"><a href="support-vector-machines.html#question-8-7"><i class="fa fa-check"></i><b>9.2.5</b> Question 8</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="deep-learning.html"><a href="deep-learning.html"><i class="fa fa-check"></i><b>10</b> Deep Learning</a><ul>
<li class="chapter" data-level="10.1" data-path="deep-learning.html"><a href="deep-learning.html#conceptual-8"><i class="fa fa-check"></i><b>10.1</b> Conceptual</a><ul>
<li class="chapter" data-level="10.1.1" data-path="deep-learning.html"><a href="deep-learning.html#question-1-8"><i class="fa fa-check"></i><b>10.1.1</b> Question 1</a></li>
<li class="chapter" data-level="10.1.2" data-path="deep-learning.html"><a href="deep-learning.html#question-2-8"><i class="fa fa-check"></i><b>10.1.2</b> Question 2</a></li>
<li class="chapter" data-level="10.1.3" data-path="deep-learning.html"><a href="deep-learning.html#question-3-8"><i class="fa fa-check"></i><b>10.1.3</b> Question 3</a></li>
<li class="chapter" data-level="10.1.4" data-path="deep-learning.html"><a href="deep-learning.html#question-4-8"><i class="fa fa-check"></i><b>10.1.4</b> Question 4</a></li>
<li class="chapter" data-level="10.1.5" data-path="deep-learning.html"><a href="deep-learning.html#question-5-8"><i class="fa fa-check"></i><b>10.1.5</b> Question 5</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="deep-learning.html"><a href="deep-learning.html#applied-8"><i class="fa fa-check"></i><b>10.2</b> Applied</a><ul>
<li class="chapter" data-level="10.2.1" data-path="deep-learning.html"><a href="deep-learning.html#question-6-8"><i class="fa fa-check"></i><b>10.2.1</b> Question 6</a></li>
<li class="chapter" data-level="10.2.2" data-path="deep-learning.html"><a href="deep-learning.html#question-7-8"><i class="fa fa-check"></i><b>10.2.2</b> Question 7</a></li>
<li class="chapter" data-level="10.2.3" data-path="deep-learning.html"><a href="deep-learning.html#question-8-8"><i class="fa fa-check"></i><b>10.2.3</b> Question 8</a></li>
<li class="chapter" data-level="10.2.4" data-path="deep-learning.html"><a href="deep-learning.html#question-9-7"><i class="fa fa-check"></i><b>10.2.4</b> Question 9</a></li>
<li class="chapter" data-level="10.2.5" data-path="deep-learning.html"><a href="deep-learning.html#question-10-6"><i class="fa fa-check"></i><b>10.2.5</b> Question 10</a></li>
<li class="chapter" data-level="10.2.6" data-path="deep-learning.html"><a href="deep-learning.html#question-11-5"><i class="fa fa-check"></i><b>10.2.6</b> Question 11</a></li>
<li class="chapter" data-level="10.2.7" data-path="deep-learning.html"><a href="deep-learning.html#question-12-4"><i class="fa fa-check"></i><b>10.2.7</b> Question 12</a></li>
<li class="chapter" data-level="10.2.8" data-path="deep-learning.html"><a href="deep-learning.html#question-13-3"><i class="fa fa-check"></i><b>10.2.8</b> Question 13</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html"><i class="fa fa-check"></i><b>11</b> Survival Analysis and Censored Data</a><ul>
<li class="chapter" data-level="11.1" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#conceptual-9"><i class="fa fa-check"></i><b>11.1</b> Conceptual</a><ul>
<li class="chapter" data-level="11.1.1" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-1-9"><i class="fa fa-check"></i><b>11.1.1</b> Question 1</a></li>
<li class="chapter" data-level="11.1.2" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-2-9"><i class="fa fa-check"></i><b>11.1.2</b> Question 2</a></li>
<li class="chapter" data-level="11.1.3" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-3-9"><i class="fa fa-check"></i><b>11.1.3</b> Question 3</a></li>
<li class="chapter" data-level="11.1.4" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-4-9"><i class="fa fa-check"></i><b>11.1.4</b> Question 4</a></li>
<li class="chapter" data-level="11.1.5" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-5-9"><i class="fa fa-check"></i><b>11.1.5</b> Question 5</a></li>
<li class="chapter" data-level="11.1.6" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-6-9"><i class="fa fa-check"></i><b>11.1.6</b> Question 6</a></li>
<li class="chapter" data-level="11.1.7" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-7-9"><i class="fa fa-check"></i><b>11.1.7</b> Question 7</a></li>
<li class="chapter" data-level="11.1.8" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-8-9"><i class="fa fa-check"></i><b>11.1.8</b> Question 8</a></li>
<li class="chapter" data-level="11.1.9" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-9-8"><i class="fa fa-check"></i><b>11.1.9</b> Question 9</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#applied-9"><i class="fa fa-check"></i><b>11.2</b> Applied</a><ul>
<li class="chapter" data-level="11.2.1" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-10-7"><i class="fa fa-check"></i><b>11.2.1</b> Question 10</a></li>
<li class="chapter" data-level="11.2.2" data-path="survival-analysis-and-censored-data.html"><a href="survival-analysis-and-censored-data.html#question-11-6"><i class="fa fa-check"></i><b>11.2.2</b> Question 11</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html"><i class="fa fa-check"></i><b>12</b> Unsupervised Learning</a><ul>
<li class="chapter" data-level="12.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#conceptual-10"><i class="fa fa-check"></i><b>12.1</b> Conceptual</a><ul>
<li class="chapter" data-level="12.1.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-1-10"><i class="fa fa-check"></i><b>12.1.1</b> Question 1</a></li>
<li class="chapter" data-level="12.1.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-2-10"><i class="fa fa-check"></i><b>12.1.2</b> Question 2</a></li>
<li class="chapter" data-level="12.1.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-3-10"><i class="fa fa-check"></i><b>12.1.3</b> Question 3</a></li>
<li class="chapter" data-level="12.1.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-4-10"><i class="fa fa-check"></i><b>12.1.4</b> Question 4</a></li>
<li class="chapter" data-level="12.1.5" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-5-10"><i class="fa fa-check"></i><b>12.1.5</b> Question 5</a></li>
<li class="chapter" data-level="12.1.6" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-6-10"><i class="fa fa-check"></i><b>12.1.6</b> Question 6</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#applied-10"><i class="fa fa-check"></i><b>12.2</b> Applied</a><ul>
<li class="chapter" data-level="12.2.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-7-10"><i class="fa fa-check"></i><b>12.2.1</b> Question 7</a></li>
<li class="chapter" data-level="12.2.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-8-10"><i class="fa fa-check"></i><b>12.2.2</b> Question 8</a></li>
<li class="chapter" data-level="12.2.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-9-9"><i class="fa fa-check"></i><b>12.2.3</b> Question 9</a></li>
<li class="chapter" data-level="12.2.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-10-8"><i class="fa fa-check"></i><b>12.2.4</b> Question 10</a></li>
<li class="chapter" data-level="12.2.5" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-11-7"><i class="fa fa-check"></i><b>12.2.5</b> Question 11</a></li>
<li class="chapter" data-level="12.2.6" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-12-5"><i class="fa fa-check"></i><b>12.2.6</b> Question 12</a></li>
<li class="chapter" data-level="12.2.7" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#question-13-4"><i class="fa fa-check"></i><b>12.2.7</b> Question 13</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multiple-testing.html"><a href="multiple-testing.html"><i class="fa fa-check"></i><b>13</b> Multiple Testing</a><ul>
<li class="chapter" data-level="13.1" data-path="multiple-testing.html"><a href="multiple-testing.html#conceptual-11"><i class="fa fa-check"></i><b>13.1</b> Conceptual</a><ul>
<li class="chapter" data-level="13.1.1" data-path="multiple-testing.html"><a href="multiple-testing.html#question-1-11"><i class="fa fa-check"></i><b>13.1.1</b> Question 1</a></li>
<li class="chapter" data-level="13.1.2" data-path="multiple-testing.html"><a href="multiple-testing.html#question-2-11"><i class="fa fa-check"></i><b>13.1.2</b> Question 2</a></li>
<li class="chapter" data-level="13.1.3" data-path="multiple-testing.html"><a href="multiple-testing.html#question-3-11"><i class="fa fa-check"></i><b>13.1.3</b> Question 3</a></li>
<li class="chapter" data-level="13.1.4" data-path="multiple-testing.html"><a href="multiple-testing.html#question-4-11"><i class="fa fa-check"></i><b>13.1.4</b> Question 4</a></li>
<li class="chapter" data-level="13.1.5" data-path="multiple-testing.html"><a href="multiple-testing.html#question-5-11"><i class="fa fa-check"></i><b>13.1.5</b> Question 5</a></li>
<li class="chapter" data-level="13.1.6" data-path="multiple-testing.html"><a href="multiple-testing.html#question-6-11"><i class="fa fa-check"></i><b>13.1.6</b> Question 6</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="multiple-testing.html"><a href="multiple-testing.html#applied-11"><i class="fa fa-check"></i><b>13.2</b> Applied</a><ul>
<li class="chapter" data-level="13.2.1" data-path="multiple-testing.html"><a href="multiple-testing.html#question-7-11"><i class="fa fa-check"></i><b>13.2.1</b> Question 7</a></li>
<li class="chapter" data-level="13.2.2" data-path="multiple-testing.html"><a href="multiple-testing.html#question-8-11"><i class="fa fa-check"></i><b>13.2.2</b> Question 8</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Statistical Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-model-selection-and-regularization" class="section level1 hasAnchor">
<h1><span class="header-section-number">6</span> Linear Model Selection and Regularization<a href="linear-model-selection-and-regularization.html#linear-model-selection-and-regularization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="conceptual-4" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.1</span> Conceptual<a href="linear-model-selection-and-regularization.html#conceptual-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="question-1-4" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.1.1</span> Question 1<a href="linear-model-selection-and-regularization.html#question-1-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>We perform best subset, forward stepwise, and backward stepwise selection on
a single data set. For each approach, we obtain <span class="math inline">\(p + 1\)</span> models, containing
<span class="math inline">\(0, 1, 2, ..., p\)</span> predictors. Explain your answers:</p>
<ol style="list-style-type: lower-alpha">
<li>Which of the three models with <span class="math inline">\(k\)</span> predictors has the smallest <em>training</em>
RSS?</li>
</ol>
</blockquote>
<p>Best subset considers the most models (all possible combinations of <span class="math inline">\(p\)</span>
predictors are considered), therefore this will give the smallest training RSS
(it will at least consider all possibilities covered by forward and backward
stepwise selection). However, all three approaches are expected to give similar
if not identical results in practice.</p>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Which of the three models with <span class="math inline">\(k\)</span> predictors has the smallest <em>test</em> RSS?</li>
</ol>
</blockquote>
<p>We cannot tell which model will perform best on the test RSS. The answer will
depend on the tradeoff between fitting to the data and overfitting.</p>
<blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>True or False:
<ol style="list-style-type: lower-roman">
<li>The predictors in the <span class="math inline">\(k\)</span>-variable model identified by forward stepwise
are a subset of the predictors in the (<span class="math inline">\(k+1\)</span>)-variable model identified
by forward stepwise selection.</li>
</ol></li>
</ol>
</blockquote>
<p>True. Forward stepwise selection retains all features identified in previous
models as <span class="math inline">\(k\)</span> is increased.</p>
<blockquote>
<ol start="2" style="list-style-type: lower-roman">
<li>The predictors in the <span class="math inline">\(k\)</span>-variable model identified by backward stepwise
are a subset of the predictors in the <span class="math inline">\((k+1)\)</span>-variable model identified
by backward stepwise selection.</li>
</ol>
</blockquote>
<p>True. Backward stepwise selection removes features one by one as <span class="math inline">\(k\)</span> is
decreased.</p>
<blockquote>
<ol start="3" style="list-style-type: lower-roman">
<li>The predictors in the <span class="math inline">\(k\)</span>-variable model identified by backward
stepwise are a subset of the predictors in the <span class="math inline">\((k+1)\)</span>-variable model
identified by forward stepwise selection.</li>
</ol>
</blockquote>
<p>False. Forward and backward stepwise selection can identify different
combinations of variables due to differing algorithms.</p>
<blockquote>
<ol start="4" style="list-style-type: lower-roman">
<li>The predictors in the <span class="math inline">\(k\)</span>-variable model identified by forward stepwise
are a subset of the predictors in the <span class="math inline">\((k+1)\)</span>-variable model identified
by backward stepwise selection.</li>
</ol>
</blockquote>
<p>False. Forward and backward stepwise selection can identify different
combinations of variables due to differing algorithms.</p>
<blockquote>
<ol start="22" style="list-style-type: lower-alpha">
<li>The predictors in the <span class="math inline">\(k\)</span>-variable model identified by best subset are a
subset of the predictors in the <span class="math inline">\((k+1)\)</span>-variable model identified by best
subset selection.</li>
</ol>
</blockquote>
<p>False. Best subset selection can identify different combinations of variables
for each <span class="math inline">\(k\)</span> by considering all possible models.</p>
</div>
<div id="question-2-4" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.1.2</span> Question 2<a href="linear-model-selection-and-regularization.html#question-2-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>For parts (a) through (c), indicate which of i. through iv. is correct.
Justify your answer.</p>
<ol style="list-style-type: lower-alpha">
<li>The lasso, relative to least squares, is:
<ol style="list-style-type: lower-roman">
<li>More flexible and hence will give improved prediction accuracy when its
increase in bias is less than its decrease in variance.</li>
<li>More flexible and hence will give improved prediction accuracy when its
increase in variance is less than its decrease in bias.</li>
<li>Less flexible and hence will give improved prediction accuracy when its
increase in bias is less than its decrease in variance.</li>
<li>Less flexible and hence will give improved prediction accuracy when
its increase in variance is less than its decrease in bias.</li>
</ol></li>
</ol>
</blockquote>
<ol start="3" style="list-style-type: lower-roman">
<li>By using shrinkage, lasso can reduce the number of predictors so is less
flexible. As a result, it will lead to an increase in bias by approximating the
true relationship. We hope that this increase is small but that we dramatically
reduce variance (i.e. the difference we would see in the model fit between
different sets of training data).</li>
</ol>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Repeat (a) for ridge regression relative to least squares.</li>
</ol>
</blockquote>
<ol start="3" style="list-style-type: lower-roman">
<li>The same is true of ridge regression—shrinkage results in a less
flexible model and can reduce variance.</li>
</ol>
<blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>Repeat (a) for non-linear methods relative to least squares.</li>
</ol>
</blockquote>
<ol start="2" style="list-style-type: lower-roman">
<li>Non-linear methods can be more flexible. They can perform better as long as
they don’t substantially increase variance.</li>
</ol>
</div>
<div id="question-3-4" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.1.3</span> Question 3<a href="linear-model-selection-and-regularization.html#question-3-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Suppose we estimate the regression coefficients in a linear regression model
by minimizing:</p>
<p><span class="math display">\[
\sum_{i=1}^n\left(y_i - \beta_0 - \sum_{j=1}^p\beta_jx_{ij}\right)^2
  \textrm{subject to} \sum_{j=1}^p|\beta_j| \le s
\]</span></p>
<p>for a particular value of <span class="math inline">\(s\)</span>. For parts (a) through (e), indicate
which of i. through v. is correct. Justify your answer.</p>
<ol style="list-style-type: lower-alpha">
<li>As we increase <span class="math inline">\(s\)</span> from 0, the training RSS will:
<ol style="list-style-type: lower-roman">
<li>Increase initially, and then eventually start decreasing in an
inverted U shape.</li>
<li>Decrease initially, and then eventually start increasing in a U shape.</li>
<li>Steadily increase.</li>
<li>Steadily decrease.</li>
<li>Remain constant.</li>
</ol></li>
</ol>
</blockquote>
<ol start="4" style="list-style-type: lower-roman">
<li>As <span class="math inline">\(s\)</span> increases, the model becomes more flexible (the sum of absolute
coefficients can be higher). With more flexible models, training RSS will
always decrease.</li>
</ol>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Repeat (a) for test RSS.</li>
</ol>
</blockquote>
<ol start="2" style="list-style-type: lower-roman">
<li>With more flexible models, test RSS will decrease (as the fit improves) and
will then increase due to overfitting (high variance).</li>
</ol>
<blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>Repeat (a) for variance.</li>
</ol>
</blockquote>
<ol start="3" style="list-style-type: lower-roman">
<li>As <span class="math inline">\(s\)</span> increases, the model becomes more flexible so variance will
increase.</li>
</ol>
<blockquote>
<ol start="4" style="list-style-type: lower-alpha">
<li>Repeat (a) for (squared) bias.</li>
</ol>
</blockquote>
<ol start="4" style="list-style-type: lower-roman">
<li>As <span class="math inline">\(s\)</span> increases, the model becomes more flexible so bias will decrease.</li>
</ol>
<blockquote>
<ol start="5" style="list-style-type: lower-alpha">
<li>Repeat (a) for the irreducible error.</li>
</ol>
</blockquote>
<ol start="22" style="list-style-type: lower-alpha">
<li>The irreducible error is unchanged.</li>
</ol>
</div>
<div id="question-4-4" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.1.4</span> Question 4<a href="linear-model-selection-and-regularization.html#question-4-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Suppose we estimate the regression coefficients in a linear regression model
by minimizing</p>
<p><span class="math display">\[
\sum_{i=1}^n \left(y_i - \beta_0 - \sum_{j=1}^p\beta_jx_{ij}\right)^2 +
  \lambda\sum_{j=1}^p\beta_j^2
\]</span></p>
<p>for a particular value of <span class="math inline">\(\lambda\)</span>. For parts (a) through (e), indicate which
of i. through v. is correct. Justify your answer.</p>
<ol style="list-style-type: lower-alpha">
<li>As we increase <span class="math inline">\(\lambda\)</span> from 0, the training RSS will:
<ol style="list-style-type: lower-roman">
<li>Increase initially, and then eventually start decreasing in an
inverted U shape.</li>
<li>Decrease initially, and then eventually start increasing in a U shape.</li>
<li>Steadily increase.</li>
<li>Steadily decrease.</li>
<li>Remain constant.</li>
</ol></li>
</ol>
</blockquote>
<ol start="3" style="list-style-type: lower-roman">
<li>As <span class="math inline">\(\lambda\)</span> is increased, more weight is placed on the sum of squared
coefficients and so the model becomes less flexible. As a result, training RSS
must increase.</li>
</ol>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Repeat (a) for test RSS.</li>
</ol>
</blockquote>
<ol start="2" style="list-style-type: lower-roman">
<li>As <span class="math inline">\(\lambda\)</span> increases, flexibility decreases so test RSS will decrease
(variance decreases) but will then increase (as bias increases).</li>
</ol>
<blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>Repeat (a) for variance.</li>
</ol>
</blockquote>
<ol start="4" style="list-style-type: lower-roman">
<li>Steadily decrease.</li>
</ol>
<blockquote>
<ol start="4" style="list-style-type: lower-alpha">
<li>Repeat (a) for (squared) bias.</li>
</ol>
</blockquote>
<ol start="3" style="list-style-type: lower-roman">
<li>Steadily increase.</li>
</ol>
<blockquote>
<ol start="5" style="list-style-type: lower-alpha">
<li>Repeat (a) for the irreducible error.</li>
</ol>
</blockquote>
<ol start="22" style="list-style-type: lower-alpha">
<li>The irreducible error is unchanged.</li>
</ol>
</div>
<div id="question-5-4" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.1.5</span> Question 5<a href="linear-model-selection-and-regularization.html#question-5-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>It is well-known that ridge regression tends to give similar coefficient
values to correlated variables, whereas the lasso may give quite different
coefficient values to correlated variables. We will now explore this property
in a very simple setting.</p>
<p>Suppose that <span class="math inline">\(n = 2, p = 2, x_{11} = x_{12}, x_{21} = x_{22}\)</span>. Furthermore,
suppose that <span class="math inline">\(y_1 + y_2 =0\)</span> and <span class="math inline">\(x_{11} + x_{21} = 0\)</span> and
<span class="math inline">\(x_{12} + x_{22} = 0\)</span>, so that the estimate for the intercept in a least
squares, ridge regression, or lasso model is zero: <span class="math inline">\(\hat{\beta}_0 = 0\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Write out the ridge regression optimization problem in this setting.</li>
</ol>
</blockquote>
<p>We are trying to minimize:</p>
<p><span class="math display">\[
\sum_{i=1}^n \left(y_i - \beta_0 - \sum_{j=1}^p\beta_jx_{ij}\right)^2 +
  \lambda\sum_{j=1}^p\beta_j^2
\]</span></p>
<p>We can ignore <span class="math inline">\(\beta_0\)</span> and can expand the sums since there’s only two terms.
Additionally, we can define <span class="math inline">\(x_1 = x_{11} = x_{12}\)</span> and
<span class="math inline">\(x_2 = x_{21} = x_{22}\)</span>. We then need to minimize</p>
<p><span class="math display">\[\begin{align}
f = &amp; (y_1 - \beta_1x_1 - \beta_2x_1)^2 + 
     (y_2 - \beta_1x_2 - \beta_2x_2)^2 + 
     \lambda\beta_1^2 + \lambda\beta_2^2 \\

f = &amp; y_1^2 - 2y_1\beta_1x_1 - 2y_1\beta_2x_1 + \beta_1^2x_1^2 + 2\beta_1\beta_2x_1^2 + \beta_2^2x_1^2 + \\
    &amp; y_2^2 - 2y_2\beta_1x_2 - 2y_2\beta_2x_2 + \beta_1^2x_2^2 + 2\beta_1\beta_2x_2^2 + \beta_2^2x_2^2 + \\
    &amp; \lambda\beta_1^2 + \lambda\beta_2^2 \\
\end{align}\]</span></p>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Argue that in this setting, the ridge coefficient estimates satisfy
<span class="math inline">\(\hat{\beta}_1 = \hat{\beta}_2\)</span></li>
</ol>
</blockquote>
<p>We can find when the above is minimized with respect to each of <span class="math inline">\(\beta_1\)</span> and
<span class="math inline">\(\beta_2\)</span> by partial differentiation.</p>
<p><span class="math display">\[
\frac{\partial}{\partial{\beta_1}} = 
  - 2y_1x_1 + 2\beta_1x_1^2 + 2\beta_2x_1^2
  - 2y_2x_2 + 2\beta_1x_2^2 + 2\beta_2x_2^2
  + 2\lambda\beta_1
\]</span></p>
<p><span class="math display">\[
\frac{\partial}{\partial{\beta_2}} = 
  - 2y_1x_1 + 2\beta_1x_1^2 + 2\beta_2x_1^2
  - 2y_2x_2 + 2\beta_1x_2^2 + 2\beta_2x_2^2
  + 2\lambda\beta_2
\]</span></p>
<p>A minimum can be found when these are set to 0.</p>
<p><span class="math display">\[
\lambda\beta_1 = y_1x_1 + y_2x_2 - \beta_1x_1^2 - \beta_2x_1^2 - \beta_1x_2^2 - \beta_2x_2^2 \\
\lambda\beta_2 = y_1x_1 + y_2x_2 - \beta_1x_1^2 - \beta_2x_1^2 - \beta_1x_2^2 - \beta_2x_2^2 
\]</span></p>
<p>Therefore <span class="math inline">\(\lambda\beta_1 = \lambda\beta_2\)</span></p>
<blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>Write out the lasso optimization problem in this setting.</li>
</ol>
</blockquote>
<p>We are trying to minimize:</p>
<p><span class="math display">\[
\sum_{i=1}^n \left(y_i - \beta_0 - \sum_{j=1}^p\beta_jx_{ij}\right)^2 +
  \lambda\sum_{j=1}^p |\beta_j|
\]</span></p>
<p>As above, we simplify to</p>
<p><span class="math display">\[
(y_1 - \beta_1x_1 - \beta_2x_1)^2 + 
  (y_2 - \beta_1x_2 - \beta_2x_2)^2 + 
  \lambda|\beta_1| + \lambda|\beta_2|
\]</span></p>
<blockquote>
<ol start="4" style="list-style-type: lower-alpha">
<li>Argue that in this setting, the lasso coefficients <span class="math inline">\(\hat{\beta}_1\)</span> and
<span class="math inline">\(\hat{\beta}_2\)</span> are not unique—in other words, there are many possible
solutions to the optimization problem in (c). Describe these solutions.</li>
</ol>
</blockquote>
<p><span class="math display">\[
\frac{\partial}{\partial{\beta_1}} = 
  - 2y_1x_1 + 2\beta_1x_1^2 + 2\beta_2x_1^2
  - 2y_2x_2 + 2\beta_1x_2^2 + 2\beta_2x_2^2
  + \lambda\frac{\beta_1}{|\beta_1|}
\]</span></p>
<p><span class="math display">\[
\frac{\partial}{\partial{\beta_2}} = 
  - 2y_1x_1 + 2\beta_1x_1^2 + 2\beta_2x_1^2
  - 2y_2x_2 + 2\beta_1x_2^2 + 2\beta_2x_2^2
  + \lambda\frac{\beta_2}{|\beta_2|}
\]</span></p>
<p>By the above logic <span class="math inline">\(\frac{|\beta_1|}{\beta_1} = \frac{|\beta_2|}{\beta_2}\)</span></p>
<p>What does this imply though???</p>
<p>ToDo</p>
</div>
<div id="question-6-4" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.1.6</span> Question 6<a href="linear-model-selection-and-regularization.html#question-6-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>We will now explore (6.12) and (6.13) further.</p>
<ol style="list-style-type: lower-alpha">
<li>Consider (6.12) with <span class="math inline">\(p = 1\)</span>. For some choice of <span class="math inline">\(y_1\)</span> and <span class="math inline">\(\lambda &gt; 0\)</span>,
plot (6.12) as a function of <span class="math inline">\(\beta_1\)</span>. Your plot should confirm that
(6.12) is solved by (6.14).</li>
</ol>
</blockquote>
<p>Equation 6.12 is:</p>
<p><span class="math display">\[
\sum_{j=1}^p(y_j - \beta_j)^2 + \lambda\sum_{j=1}^p\beta_j^2
\]</span></p>
<p>Equation 6.14 is:</p>
<p><span class="math display">\[
\hat{\beta}_j^R = y_j/(1 + \lambda)
\]</span></p>
<p>where <span class="math inline">\(\hat{\beta}_j^R\)</span> is the ridge regression estimate.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="linear-model-selection-and-regularization.html#cb333-1"></a>lambda &lt;-<span class="st"> </span><span class="fl">0.7</span></span>
<span id="cb333-2"><a href="linear-model-selection-and-regularization.html#cb333-2"></a>y &lt;-<span class="st"> </span><span class="fl">1.4</span></span>
<span id="cb333-3"><a href="linear-model-selection-and-regularization.html#cb333-3"></a>fn &lt;-<span class="st"> </span><span class="cf">function</span>(beta) {</span>
<span id="cb333-4"><a href="linear-model-selection-and-regularization.html#cb333-4"></a>  (y <span class="op">-</span><span class="st"> </span>beta)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>lambda<span class="op">*</span>beta<span class="op">^</span><span class="dv">2</span></span>
<span id="cb333-5"><a href="linear-model-selection-and-regularization.html#cb333-5"></a>}</span>
<span id="cb333-6"><a href="linear-model-selection-and-regularization.html#cb333-6"></a><span class="kw">plot</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="fl">0.01</span>), <span class="kw">fn</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="fl">0.01</span>)), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;beta&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;6.12&quot;</span>)</span>
<span id="cb333-7"><a href="linear-model-selection-and-regularization.html#cb333-7"></a><span class="kw">abline</span>(<span class="dt">v =</span> y<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>lambda), <span class="dt">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="06-linear-model-selection-and-regularization_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Consider (6.13) with <span class="math inline">\(p = 1\)</span>. For some choice of <span class="math inline">\(y_1\)</span> and <span class="math inline">\(\lambda &gt; 0\)</span>,
plot (6.13) as a function of <span class="math inline">\(\beta_1\)</span>. Your plot should confirm that
(6.13) is solved by (6.15).</li>
</ol>
</blockquote>
<p>Equation 6.13 is:</p>
<p><span class="math display">\[
\sum_{j=1}^p(y_j - \beta_j)^2 + \lambda\sum_{j=1}^p|\beta_j|
\]</span></p>
<p>Equation 6.15 is:</p>
<p><span class="math display">\[
\hat{\beta}_j^L = \begin{cases}
  y_j - \lambda/2 &amp;\mbox{if } y_j &gt; \lambda/2; \\
  y_j + \lambda/2 &amp;\mbox{if } y_j &lt; -\lambda/2; \\
  0               &amp;\mbox{if } |y_j| \le \lambda/2;
\end{cases}
\]</span></p>
<p>For <span class="math inline">\(\lambda = 0.7\)</span> and <span class="math inline">\(y = 1.4\)</span>, the top case applies.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="linear-model-selection-and-regularization.html#cb334-1"></a>lambda &lt;-<span class="st"> </span><span class="fl">0.7</span></span>
<span id="cb334-2"><a href="linear-model-selection-and-regularization.html#cb334-2"></a>y &lt;-<span class="st"> </span><span class="fl">1.4</span></span>
<span id="cb334-3"><a href="linear-model-selection-and-regularization.html#cb334-3"></a>fn &lt;-<span class="st"> </span><span class="cf">function</span>(beta) {</span>
<span id="cb334-4"><a href="linear-model-selection-and-regularization.html#cb334-4"></a>  (y <span class="op">-</span><span class="st"> </span>beta)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>lambda<span class="op">*</span><span class="kw">abs</span>(beta)</span>
<span id="cb334-5"><a href="linear-model-selection-and-regularization.html#cb334-5"></a>}</span>
<span id="cb334-6"><a href="linear-model-selection-and-regularization.html#cb334-6"></a><span class="kw">plot</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="fl">0.01</span>), <span class="kw">fn</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="fl">0.01</span>)), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;beta&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;6.12&quot;</span>)</span>
<span id="cb334-7"><a href="linear-model-selection-and-regularization.html#cb334-7"></a><span class="kw">abline</span>(<span class="dt">v =</span> y <span class="op">-</span><span class="st">  </span>lambda<span class="op">/</span><span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="06-linear-model-selection-and-regularization_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="question-7-4" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.1.7</span> Question 7<a href="linear-model-selection-and-regularization.html#question-7-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>We will now derive the Bayesian connection to the lasso and ridge regression
discussed in Section 6.2.2.</p>
<ol style="list-style-type: lower-alpha">
<li>Suppose that <span class="math inline">\(y_i = \beta_0 + \sum_{j=1}^p x_{ij}\beta_j + \epsilon_i\)</span>
where <span class="math inline">\(\epsilon_1, ..., \epsilon_n\)</span> are independent and identically
distributed from a <span class="math inline">\(N(0, \sigma^2)\)</span> distribution. Write out the likelihood
for the data.</li>
</ol>
</blockquote>
<p><span class="math display">\[\begin{align*}
\mathcal{L} 
  &amp;= \prod_i^n \mathcal{N}(0, \sigma^2) \\
  &amp;= \prod_i^n \frac{1}{\sqrt{2\pi\sigma}}\exp\left(-\frac{\epsilon_i^2}{2\sigma^2}\right) \\
  &amp;= \left(\frac{1}{\sqrt{2\pi\sigma}}\right)^n \exp\left(-\frac{1}{2\sigma^2} \sum_i^n \epsilon_i^2\right)
\end{align*}\]</span></p>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Assume the following prior for <span class="math inline">\(\beta\)</span>: <span class="math inline">\(\beta_1, ..., \beta_p\)</span> are
independent and identically distributed according to a double-exponential
distribution with mean 0 and common scale parameter b: i.e.
<span class="math inline">\(p(\beta) = \frac{1}{2b}\exp(-|\beta|/b)\)</span>. Write out the posterior for
<span class="math inline">\(\beta\)</span> in this setting.</li>
</ol>
</blockquote>
<p>The posterior can be calculated by multiplying the prior and likelihood
(up to a proportionality constant).</p>
<p><span class="math display">\[\begin{align*}
p(\beta|X,Y) 
  &amp;\propto \left(\frac{1}{\sqrt{2\pi\sigma}}\right)^n \exp\left(-\frac{1}{2\sigma^2} \sum_i^n \epsilon_i^2\right) \prod_j^p\frac{1}{2b}\exp\left(-\frac{|\beta_j|}{b}\right)  \\
  &amp;\propto \frac{1}{2b} \left(\frac{1}{\sqrt{2\pi\sigma}}\right)^n \exp\left(-\frac{1}{2\sigma^2} \sum_i^n \epsilon_i^2 -\sum_j^p\frac{|\beta_j|}{b}\right)
\end{align*}\]</span></p>
<blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>Argue that the lasso estimate is the <em>mode</em> for <span class="math inline">\(\beta\)</span> under this
posterior distribution.</li>
</ol>
</blockquote>
<p>Let us find the maximum of the posterior distribution (the mode). Maximizing
the posterior probability is equivalent to maximizing its log which is:</p>
<p><span class="math display">\[
\log(p(\beta|X,Y)) \propto  \log\left[ \frac{1}{2b} \left(\frac{1}{\sqrt{2\pi\sigma}}\right)^n \right ] - \left(\frac{1}{2\sigma^2} \sum_i^n \epsilon_i^2 + \sum_j^p\frac{|\beta_j|}{b}\right)
\]</span></p>
<p>Since, the first term is independent of <span class="math inline">\(\beta\)</span>, our solution will be when
we minimize the second term.</p>
<p><span class="math display">\[\begin{align*}
\DeclareMathOperator*{\argmin}{arg\,min} % Jan Hlavacek
\argmin_\beta \left(\frac{1}{2\sigma^2} \sum_i^n \epsilon_i^2 + \sum_j^p\frac{|\beta|}{b}\right)
&amp;= \argmin_\beta \left(\frac{1}{2\sigma^2} \right ) \left( \sum_i^n \epsilon_i^2 +\frac{2\sigma^2}{b}\sum_j^p|\beta_j|\right) \\
&amp;= \argmin_\beta \left( \sum_i^n \epsilon_i^2 +\frac{2\sigma^2}{b}\sum_j^p|\beta_j|\right)
\end{align*}\]</span></p>
<p>Note, that <span class="math inline">\(RSS = \sum_i^n \epsilon_i^2\)</span> and if we set <span class="math inline">\(\lambda = \frac{2\sigma^2}{b}\)</span>, the mode corresponds to lasso optimization.
<span class="math display">\[
\argmin_\beta RSS + \lambda\sum_j^p|\beta_j|
\]</span></p>
<blockquote>
<ol start="4" style="list-style-type: lower-alpha">
<li>Now assume the following prior for <span class="math inline">\(\beta\)</span>: <span class="math inline">\(\beta_1, ..., \beta_p\)</span> are
independent and identically distributed according to a normal distribution
with mean zero and variance <span class="math inline">\(c\)</span>. Write out the posterior for <span class="math inline">\(\beta\)</span> in
this setting.</li>
</ol>
</blockquote>
<p>The posterior is now:</p>
<p><span class="math display">\[\begin{align*}
p(\beta|X,Y) 
  &amp;\propto \left(\frac{1}{\sqrt{2\pi\sigma}}\right)^n \exp\left(-\frac{1}{2\sigma^2} \sum_i^n \epsilon_i^2\right) \prod_j^p\frac{1}{\sqrt{2\pi c}}\exp\left(-\frac{\beta_j^2}{2c}\right)  \\
  &amp;\propto 
   \left(\frac{1}{\sqrt{2\pi\sigma}}\right)^n 
   \left(\frac{1}{\sqrt{2\pi c}}\right)^p
\exp\left(-\frac{1}{2\sigma^2} \sum_i^n \epsilon_i^2 - \frac{1}{2c}\sum_j^p\beta_j^2\right)
\end{align*}\]</span></p>
<blockquote>
<ol start="5" style="list-style-type: lower-alpha">
<li>Argue that the ridge regression estimate is both the <em>mode</em> and the <em>mean</em>
for <span class="math inline">\(\beta\)</span> under this posterior distribution.</li>
</ol>
</blockquote>
<p>To show that the ridge estimate is the mode we can again find the maximum by
maximizing the log of the posterior. The log is</p>
<p><span class="math display">\[
\log{p(\beta|X,Y)}
  \propto 
   \log{\left[\left(\frac{1}{\sqrt{2\pi\sigma}}\right)^n \left(\frac{1}{\sqrt{2\pi c}}\right)^p \right ]}
- \left(\frac{1}{2\sigma^2} \sum_i^n \epsilon_i^2 + \frac{1}{2c}\sum_j^p\beta_j^2 \right)
\]</span></p>
<p>We can maximize (wrt <span class="math inline">\(\beta\)</span>) by ignoring the first term and minimizing the
second term. i.e. we minimize:</p>
<p><span class="math display">\[
\argmin_\beta \left( \frac{1}{2\sigma^2} \sum_i^n \epsilon_i^2 + \frac{1}{2c}\sum_j^p\beta_j^2 \right)\\
= \argmin_\beta \left( \frac{1}{2\sigma^2} \left( \sum_i^n \epsilon_i^2 + \frac{\sigma^2}{c}\sum_j^p\beta_j^2 \right) \right)
\]</span></p>
<p>As above, if <span class="math inline">\(RSS = \sum_i^n \epsilon_i^2\)</span> and if we set <span class="math inline">\(\lambda = \frac{\sigma^2}{c}\)</span>, we can see that the mode corresponds to ridge optimization.</p>
</div>
</div>
<div id="applied-4" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.2</span> Applied<a href="linear-model-selection-and-regularization.html#applied-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="question-8-4" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.2.1</span> Question 8<a href="linear-model-selection-and-regularization.html#question-8-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>In this exercise, we will generate simulated data, and will then use this
data to perform best subset selection.</p>
<ol style="list-style-type: lower-alpha">
<li>Use the <code>rnorm()</code> function to generate a predictor <span class="math inline">\(X\)</span> of length <span class="math inline">\(n = 100\)</span>,
as well as a noise vector <span class="math inline">\(\epsilon\)</span> of length <span class="math inline">\(n = 100\)</span>.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="linear-model-selection-and-regularization.html#cb335-1"></a><span class="kw">library</span>(ISLR2)</span>
<span id="cb335-2"><a href="linear-model-selection-and-regularization.html#cb335-2"></a><span class="kw">library</span>(glmnet)</span>
<span id="cb335-3"><a href="linear-model-selection-and-regularization.html#cb335-3"></a><span class="kw">library</span>(leaps)</span>
<span id="cb335-4"><a href="linear-model-selection-and-regularization.html#cb335-4"></a><span class="kw">library</span>(pls)</span></code></pre></div>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="linear-model-selection-and-regularization.html#cb336-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb336-2"><a href="linear-model-selection-and-regularization.html#cb336-2"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb336-3"><a href="linear-model-selection-and-regularization.html#cb336-3"></a>ep &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</span></code></pre></div>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Generate a response vector <span class="math inline">\(Y\)</span> of length <span class="math inline">\(n = 100\)</span> according to the model
<span class="math display">\[Y = \beta_0 + \beta_1X + \beta_2X^2 + \beta_3X^3 + \epsilon,\]</span>
where <span class="math inline">\(\beta_0, \beta_1, \beta_2,\)</span> and <span class="math inline">\(\beta_3\)</span> are constants of your
choice.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="linear-model-selection-and-regularization.html#cb337-1"></a>y &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>x <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>x<span class="op">^</span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span>ep</span></code></pre></div>
<blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>Use the <code>regsubsets()</code> function to perform best subset selection in order
to choose the best model containing the predictors <span class="math inline">\(X, X^2, ..., X^{10}\)</span>.
What is the best model obtained according to <span class="math inline">\(C_p\)</span>, BIC, and adjusted
<span class="math inline">\(R^2\)</span>? Show some plots to provide evidence for your answer, and report the
coefficients of the best model obtained. Note you will need to use the
<code>data.frame()</code> function to create a single data set containing both <span class="math inline">\(X\)</span> and
<span class="math inline">\(Y\)</span>.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="linear-model-selection-and-regularization.html#cb338-1"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x, y)</span>
<span id="cb338-2"><a href="linear-model-selection-and-regularization.html#cb338-2"></a><span class="kw">summary</span>(<span class="kw">regsubsets</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dv">10</span>, <span class="dt">raw =</span> <span class="ot">TRUE</span>), <span class="dt">data =</span> dat))</span></code></pre></div>
<pre><code>## Subset selection object
## Call: regsubsets.formula(y ~ poly(x, 10, raw = TRUE), data = dat)
## 10 Variables  (and intercept)
##                           Forced in Forced out
## poly(x, 10, raw = TRUE)1      FALSE      FALSE
## poly(x, 10, raw = TRUE)2      FALSE      FALSE
## poly(x, 10, raw = TRUE)3      FALSE      FALSE
## poly(x, 10, raw = TRUE)4      FALSE      FALSE
## poly(x, 10, raw = TRUE)5      FALSE      FALSE
## poly(x, 10, raw = TRUE)6      FALSE      FALSE
## poly(x, 10, raw = TRUE)7      FALSE      FALSE
## poly(x, 10, raw = TRUE)8      FALSE      FALSE
## poly(x, 10, raw = TRUE)9      FALSE      FALSE
## poly(x, 10, raw = TRUE)10     FALSE      FALSE
## 1 subsets of each size up to 8
## Selection Algorithm: exhaustive
##          poly(x, 10, raw = TRUE)1 poly(x, 10, raw = TRUE)2
## 1  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 2  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 3  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 4  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 5  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 6  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 7  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 8  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
##          poly(x, 10, raw = TRUE)3 poly(x, 10, raw = TRUE)4
## 1  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 2  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 3  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 4  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 5  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 6  ( 1 ) &quot; &quot;                      &quot;*&quot;                     
## 7  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 8  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
##          poly(x, 10, raw = TRUE)5 poly(x, 10, raw = TRUE)6
## 1  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 2  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 3  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 4  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 5  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 6  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 7  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 8  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
##          poly(x, 10, raw = TRUE)7 poly(x, 10, raw = TRUE)8
## 1  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 2  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 3  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 4  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 5  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 6  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 7  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 8  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
##          poly(x, 10, raw = TRUE)9 poly(x, 10, raw = TRUE)10
## 1  ( 1 ) &quot; &quot;                      &quot; &quot;                      
## 2  ( 1 ) &quot; &quot;                      &quot; &quot;                      
## 3  ( 1 ) &quot; &quot;                      &quot; &quot;                      
## 4  ( 1 ) &quot; &quot;                      &quot; &quot;                      
## 5  ( 1 ) &quot;*&quot;                      &quot; &quot;                      
## 6  ( 1 ) &quot;*&quot;                      &quot; &quot;                      
## 7  ( 1 ) &quot;*&quot;                      &quot; &quot;                      
## 8  ( 1 ) &quot;*&quot;                      &quot; &quot;</code></pre>
<blockquote>
<ol start="4" style="list-style-type: lower-alpha">
<li>Repeat (c), using forward stepwise selection and also using backwards
stepwise selection. How does your answer compare to the results in (c)?</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="linear-model-selection-and-regularization.html#cb340-1"></a><span class="kw">summary</span>(<span class="kw">regsubsets</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dv">10</span>, <span class="dt">raw =</span> <span class="ot">TRUE</span>), <span class="dt">data =</span> dat, <span class="dt">method =</span> <span class="st">&quot;forward&quot;</span>))</span></code></pre></div>
<pre><code>## Subset selection object
## Call: regsubsets.formula(y ~ poly(x, 10, raw = TRUE), data = dat, method = &quot;forward&quot;)
## 10 Variables  (and intercept)
##                           Forced in Forced out
## poly(x, 10, raw = TRUE)1      FALSE      FALSE
## poly(x, 10, raw = TRUE)2      FALSE      FALSE
## poly(x, 10, raw = TRUE)3      FALSE      FALSE
## poly(x, 10, raw = TRUE)4      FALSE      FALSE
## poly(x, 10, raw = TRUE)5      FALSE      FALSE
## poly(x, 10, raw = TRUE)6      FALSE      FALSE
## poly(x, 10, raw = TRUE)7      FALSE      FALSE
## poly(x, 10, raw = TRUE)8      FALSE      FALSE
## poly(x, 10, raw = TRUE)9      FALSE      FALSE
## poly(x, 10, raw = TRUE)10     FALSE      FALSE
## 1 subsets of each size up to 8
## Selection Algorithm: forward
##          poly(x, 10, raw = TRUE)1 poly(x, 10, raw = TRUE)2
## 1  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 2  ( 1 ) &quot; &quot;                      &quot;*&quot;                     
## 3  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 4  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 5  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 6  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 7  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 8  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
##          poly(x, 10, raw = TRUE)3 poly(x, 10, raw = TRUE)4
## 1  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 2  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 3  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 4  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 5  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 6  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 7  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 8  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
##          poly(x, 10, raw = TRUE)5 poly(x, 10, raw = TRUE)6
## 1  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 2  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 3  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 4  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 5  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 6  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 7  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 8  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
##          poly(x, 10, raw = TRUE)7 poly(x, 10, raw = TRUE)8
## 1  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 2  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 3  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 4  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 5  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 6  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 7  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 8  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
##          poly(x, 10, raw = TRUE)9 poly(x, 10, raw = TRUE)10
## 1  ( 1 ) &quot; &quot;                      &quot; &quot;                      
## 2  ( 1 ) &quot; &quot;                      &quot; &quot;                      
## 3  ( 1 ) &quot; &quot;                      &quot; &quot;                      
## 4  ( 1 ) &quot; &quot;                      &quot; &quot;                      
## 5  ( 1 ) &quot;*&quot;                      &quot; &quot;                      
## 6  ( 1 ) &quot;*&quot;                      &quot; &quot;                      
## 7  ( 1 ) &quot;*&quot;                      &quot; &quot;                      
## 8  ( 1 ) &quot;*&quot;                      &quot;*&quot;</code></pre>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="linear-model-selection-and-regularization.html#cb342-1"></a><span class="kw">summary</span>(<span class="kw">regsubsets</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dv">10</span>, <span class="dt">raw =</span> <span class="ot">TRUE</span>), <span class="dt">data =</span> dat, <span class="dt">method =</span> <span class="st">&quot;backward&quot;</span>))</span></code></pre></div>
<pre><code>## Subset selection object
## Call: regsubsets.formula(y ~ poly(x, 10, raw = TRUE), data = dat, method = &quot;backward&quot;)
## 10 Variables  (and intercept)
##                           Forced in Forced out
## poly(x, 10, raw = TRUE)1      FALSE      FALSE
## poly(x, 10, raw = TRUE)2      FALSE      FALSE
## poly(x, 10, raw = TRUE)3      FALSE      FALSE
## poly(x, 10, raw = TRUE)4      FALSE      FALSE
## poly(x, 10, raw = TRUE)5      FALSE      FALSE
## poly(x, 10, raw = TRUE)6      FALSE      FALSE
## poly(x, 10, raw = TRUE)7      FALSE      FALSE
## poly(x, 10, raw = TRUE)8      FALSE      FALSE
## poly(x, 10, raw = TRUE)9      FALSE      FALSE
## poly(x, 10, raw = TRUE)10     FALSE      FALSE
## 1 subsets of each size up to 8
## Selection Algorithm: backward
##          poly(x, 10, raw = TRUE)1 poly(x, 10, raw = TRUE)2
## 1  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 2  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 3  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 4  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 5  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 6  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 7  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 8  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
##          poly(x, 10, raw = TRUE)3 poly(x, 10, raw = TRUE)4
## 1  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 2  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 3  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 4  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 5  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 6  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 7  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 8  ( 1 ) &quot; &quot;                      &quot; &quot;                     
##          poly(x, 10, raw = TRUE)5 poly(x, 10, raw = TRUE)6
## 1  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 2  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 3  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 4  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 5  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 6  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 7  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 8  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
##          poly(x, 10, raw = TRUE)7 poly(x, 10, raw = TRUE)8
## 1  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 2  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 3  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 4  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 5  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 6  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 7  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 8  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
##          poly(x, 10, raw = TRUE)9 poly(x, 10, raw = TRUE)10
## 1  ( 1 ) &quot; &quot;                      &quot; &quot;                      
## 2  ( 1 ) &quot; &quot;                      &quot; &quot;                      
## 3  ( 1 ) &quot; &quot;                      &quot; &quot;                      
## 4  ( 1 ) &quot; &quot;                      &quot; &quot;                      
## 5  ( 1 ) &quot;*&quot;                      &quot; &quot;                      
## 6  ( 1 ) &quot;*&quot;                      &quot; &quot;                      
## 7  ( 1 ) &quot;*&quot;                      &quot; &quot;                      
## 8  ( 1 ) &quot;*&quot;                      &quot;*&quot;</code></pre>
<blockquote>
<ol start="5" style="list-style-type: lower-alpha">
<li>Now fit a lasso model to the simulated data, again using
<span class="math inline">\(X, X^2, ..., X^{10}\)</span> as predictors. Use cross-validation to select the
optimal value of <span class="math inline">\(\lambda\)</span>. Create plots of the cross-validation error as a
function of <span class="math inline">\(\lambda\)</span>. Report the resulting coefficient estimates, and
discuss the results obtained.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="linear-model-selection-and-regularization.html#cb344-1"></a>res &lt;-<span class="st"> </span><span class="kw">cv.glmnet</span>(<span class="kw">poly</span>(dat<span class="op">$</span>x, <span class="dv">10</span>, <span class="dt">raw =</span> <span class="ot">TRUE</span>), dat<span class="op">$</span>y, <span class="dt">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb344-2"><a href="linear-model-selection-and-regularization.html#cb344-2"></a>(best &lt;-<span class="st"> </span>res<span class="op">$</span>lambda.min)</span></code></pre></div>
<pre><code>## [1] 0.09804219</code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="linear-model-selection-and-regularization.html#cb346-1"></a><span class="kw">plot</span>(res)</span></code></pre></div>
<p><img src="06-linear-model-selection-and-regularization_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="linear-model-selection-and-regularization.html#cb347-1"></a>out =<span class="st"> </span><span class="kw">glmnet</span>(<span class="kw">poly</span>(dat<span class="op">$</span>x, <span class="dv">10</span>, <span class="dt">raw =</span> <span class="ot">TRUE</span>), dat<span class="op">$</span>y, <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">lambda =</span> res<span class="op">$</span>lambda.min)</span>
<span id="cb347-2"><a href="linear-model-selection-and-regularization.html#cb347-2"></a><span class="kw">predict</span>(out, <span class="dt">type =</span> <span class="st">&quot;coefficients&quot;</span>, <span class="dt">s =</span> best)</span></code></pre></div>
<pre><code>## 11 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                     s1
## (Intercept)  1.8457308
## 1            2.9092918
## 2           -1.9287428
## 3            0.5161012
## 4            .        
## 5            .        
## 6            .        
## 7            .        
## 8            .        
## 9            .        
## 10           .</code></pre>
<p>When fitting lasso, the model that minimizes MSE uses three predictors (as per
the simulation). The coefficients estimated (2.9, -1.9 and 0.5) are similar to
those used in the simulation.</p>
<blockquote>
<ol start="6" style="list-style-type: lower-alpha">
<li>Now generate a response vector <span class="math inline">\(Y\)</span> according to the model
<span class="math display">\[Y = \beta_0 + \beta_7X^7 + \epsilon,\]</span> and perform best subset selection
and the lasso. Discuss the results obtained.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="linear-model-selection-and-regularization.html#cb349-1"></a>dat<span class="op">$</span>y &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span> <span class="fl">+0.2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">7</span> <span class="op">+</span><span class="st"> </span>ep</span>
<span id="cb349-2"><a href="linear-model-selection-and-regularization.html#cb349-2"></a><span class="kw">summary</span>(<span class="kw">regsubsets</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dv">10</span>, <span class="dt">raw =</span> <span class="ot">TRUE</span>), <span class="dt">data =</span> dat))</span></code></pre></div>
<pre><code>## Subset selection object
## Call: regsubsets.formula(y ~ poly(x, 10, raw = TRUE), data = dat)
## 10 Variables  (and intercept)
##                           Forced in Forced out
## poly(x, 10, raw = TRUE)1      FALSE      FALSE
## poly(x, 10, raw = TRUE)2      FALSE      FALSE
## poly(x, 10, raw = TRUE)3      FALSE      FALSE
## poly(x, 10, raw = TRUE)4      FALSE      FALSE
## poly(x, 10, raw = TRUE)5      FALSE      FALSE
## poly(x, 10, raw = TRUE)6      FALSE      FALSE
## poly(x, 10, raw = TRUE)7      FALSE      FALSE
## poly(x, 10, raw = TRUE)8      FALSE      FALSE
## poly(x, 10, raw = TRUE)9      FALSE      FALSE
## poly(x, 10, raw = TRUE)10     FALSE      FALSE
## 1 subsets of each size up to 8
## Selection Algorithm: exhaustive
##          poly(x, 10, raw = TRUE)1 poly(x, 10, raw = TRUE)2
## 1  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 2  ( 1 ) &quot; &quot;                      &quot;*&quot;                     
## 3  ( 1 ) &quot; &quot;                      &quot;*&quot;                     
## 4  ( 1 ) &quot; &quot;                      &quot;*&quot;                     
## 5  ( 1 ) &quot; &quot;                      &quot;*&quot;                     
## 6  ( 1 ) &quot; &quot;                      &quot;*&quot;                     
## 7  ( 1 ) &quot; &quot;                      &quot;*&quot;                     
## 8  ( 1 ) &quot; &quot;                      &quot;*&quot;                     
##          poly(x, 10, raw = TRUE)3 poly(x, 10, raw = TRUE)4
## 1  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 2  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 3  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 4  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 5  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 6  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 7  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 8  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
##          poly(x, 10, raw = TRUE)5 poly(x, 10, raw = TRUE)6
## 1  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 2  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 3  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 4  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 5  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 6  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 7  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
## 8  ( 1 ) &quot;*&quot;                      &quot;*&quot;                     
##          poly(x, 10, raw = TRUE)7 poly(x, 10, raw = TRUE)8
## 1  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 2  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 3  ( 1 ) &quot;*&quot;                      &quot; &quot;                     
## 4  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 5  ( 1 ) &quot; &quot;                      &quot; &quot;                     
## 6  ( 1 ) &quot; &quot;                      &quot;*&quot;                     
## 7  ( 1 ) &quot; &quot;                      &quot;*&quot;                     
## 8  ( 1 ) &quot; &quot;                      &quot;*&quot;                     
##          poly(x, 10, raw = TRUE)9 poly(x, 10, raw = TRUE)10
## 1  ( 1 ) &quot; &quot;                      &quot; &quot;                      
## 2  ( 1 ) &quot; &quot;                      &quot; &quot;                      
## 3  ( 1 ) &quot; &quot;                      &quot; &quot;                      
## 4  ( 1 ) &quot;*&quot;                      &quot; &quot;                      
## 5  ( 1 ) &quot;*&quot;                      &quot; &quot;                      
## 6  ( 1 ) &quot;*&quot;                      &quot; &quot;                      
## 7  ( 1 ) &quot;*&quot;                      &quot;*&quot;                      
## 8  ( 1 ) &quot;*&quot;                      &quot;*&quot;</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="linear-model-selection-and-regularization.html#cb351-1"></a>res &lt;-<span class="st"> </span><span class="kw">cv.glmnet</span>(<span class="kw">poly</span>(dat<span class="op">$</span>x, <span class="dv">10</span>, <span class="dt">raw =</span> <span class="ot">TRUE</span>), dat<span class="op">$</span>y, <span class="dt">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb351-2"><a href="linear-model-selection-and-regularization.html#cb351-2"></a>(best &lt;-<span class="st"> </span>res<span class="op">$</span>lambda.min)</span></code></pre></div>
<pre><code>## [1] 1.126906</code></pre>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="linear-model-selection-and-regularization.html#cb353-1"></a><span class="kw">plot</span>(res)</span></code></pre></div>
<p><img src="06-linear-model-selection-and-regularization_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="linear-model-selection-and-regularization.html#cb354-1"></a>out =<span class="st"> </span><span class="kw">glmnet</span>(<span class="kw">poly</span>(dat<span class="op">$</span>x, <span class="dv">10</span>, <span class="dt">raw =</span> <span class="ot">TRUE</span>), dat<span class="op">$</span>y, <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">lambda =</span> best)</span>
<span id="cb354-2"><a href="linear-model-selection-and-regularization.html#cb354-2"></a><span class="kw">predict</span>(out, <span class="dt">type =</span> <span class="st">&quot;coefficients&quot;</span>, <span class="dt">s =</span> best)</span></code></pre></div>
<pre><code>## 11 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                       s1
## (Intercept)  1.061389580
## 1            .          
## 2           -0.883080980
## 3            .          
## 4           -0.121018425
## 5            0.028984084
## 6           -0.009540039
## 7            0.188796928
## 8            .          
## 9            .          
## 10           .</code></pre>
<p>When fitting lasso, the model does not perfectly replicate the simulation
(coefficients are retained for powers of <span class="math inline">\(x\)</span> that were not simulated).</p>
</div>
<div id="question-9-4" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.2.2</span> Question 9<a href="linear-model-selection-and-regularization.html#question-9-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>In this exercise, we will predict the number of applications received using
the other variables in the <code>College</code> data set.</p>
<ol style="list-style-type: lower-alpha">
<li>Split the data set into a training set and a test set.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="linear-model-selection-and-regularization.html#cb356-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb356-2"><a href="linear-model-selection-and-regularization.html#cb356-2"></a>train &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">nrow</span>(College), <span class="kw">nrow</span>(College)<span class="op">*</span><span class="dv">2</span><span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb356-3"><a href="linear-model-selection-and-regularization.html#cb356-3"></a>test &lt;-<span class="st"> </span><span class="kw">setdiff</span>(<span class="kw">seq_len</span>(<span class="kw">nrow</span>(College)), train)</span>
<span id="cb356-4"><a href="linear-model-selection-and-regularization.html#cb356-4"></a>mse &lt;-<span class="st"> </span><span class="kw">list</span>()</span></code></pre></div>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Fit a linear model using least squares on the training set, and report the
test error obtained.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="linear-model-selection-and-regularization.html#cb357-1"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(Apps <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> College[train, ])</span>
<span id="cb357-2"><a href="linear-model-selection-and-regularization.html#cb357-2"></a>(mse<span class="op">$</span>lm &lt;-<span class="st"> </span><span class="kw">mean</span>((<span class="kw">predict</span>(fit, College[test, ]) <span class="op">-</span><span class="st"> </span>College<span class="op">$</span>Apps[test]) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 1695269</code></pre>
<blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>Fit a ridge regression model on the training set, with <span class="math inline">\(\lambda\)</span> chosen by
cross-validation. Report the test error obtained.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="linear-model-selection-and-regularization.html#cb359-1"></a>mm &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(Apps <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> College[train, ])</span>
<span id="cb359-2"><a href="linear-model-selection-and-regularization.html#cb359-2"></a>fit2 &lt;-<span class="st"> </span><span class="kw">cv.glmnet</span>(mm, College<span class="op">$</span>Apps[train], <span class="dt">alpha =</span> <span class="dv">0</span>)</span>
<span id="cb359-3"><a href="linear-model-selection-and-regularization.html#cb359-3"></a>p &lt;-<span class="st"> </span><span class="kw">predict</span>(fit2, <span class="kw">model.matrix</span>(Apps <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> College[test, ]), <span class="dt">s =</span> fit2<span class="op">$</span>lambda.min)</span>
<span id="cb359-4"><a href="linear-model-selection-and-regularization.html#cb359-4"></a>(mse<span class="op">$</span>ridge &lt;-<span class="st"> </span><span class="kw">mean</span>((p <span class="op">-</span><span class="st"> </span>College<span class="op">$</span>Apps[test]) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 2804369</code></pre>
<blockquote>
<ol start="4" style="list-style-type: lower-alpha">
<li>Fit a lasso model on the training set, with <span class="math inline">\(\lambda\)</span> chosen by cross-
validation. Report the test error obtained, along with the number of
non-zero coefficient estimates.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="linear-model-selection-and-regularization.html#cb361-1"></a>mm &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(Apps <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> College[train, ])</span>
<span id="cb361-2"><a href="linear-model-selection-and-regularization.html#cb361-2"></a>fit3 &lt;-<span class="st"> </span><span class="kw">cv.glmnet</span>(mm, College<span class="op">$</span>Apps[train], <span class="dt">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb361-3"><a href="linear-model-selection-and-regularization.html#cb361-3"></a>p &lt;-<span class="st"> </span><span class="kw">predict</span>(fit3, <span class="kw">model.matrix</span>(Apps <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> College[test, ]), <span class="dt">s =</span> fit3<span class="op">$</span>lambda.min)</span>
<span id="cb361-4"><a href="linear-model-selection-and-regularization.html#cb361-4"></a>(mse<span class="op">$</span>lasso &lt;-<span class="st"> </span><span class="kw">mean</span>((p <span class="op">-</span><span class="st"> </span>College<span class="op">$</span>Apps[test]) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 1822322</code></pre>
<blockquote>
<ol start="5" style="list-style-type: lower-alpha">
<li>Fit a PCR model on the training set, with <span class="math inline">\(M\)</span> chosen by cross-validation.
Report the test error obtained, along with the value of <span class="math inline">\(M\)</span> selected by
cross-validation.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="linear-model-selection-and-regularization.html#cb363-1"></a>fit4 &lt;-<span class="st"> </span><span class="kw">pcr</span>(Apps <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> College[train, ], <span class="dt">scale =</span> <span class="ot">TRUE</span>, <span class="dt">validation =</span> <span class="st">&quot;CV&quot;</span>)</span>
<span id="cb363-2"><a href="linear-model-selection-and-regularization.html#cb363-2"></a><span class="kw">validationplot</span>(fit4, <span class="dt">val.type =</span> <span class="st">&quot;MSEP&quot;</span>)</span></code></pre></div>
<p><img src="06-linear-model-selection-and-regularization_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="linear-model-selection-and-regularization.html#cb364-1"></a>p &lt;-<span class="st"> </span><span class="kw">predict</span>(fit4, College[test, ], <span class="dt">ncomp =</span> <span class="dv">17</span>)</span>
<span id="cb364-2"><a href="linear-model-selection-and-regularization.html#cb364-2"></a>(mse<span class="op">$</span>pcr &lt;-<span class="st"> </span><span class="kw">mean</span>((p <span class="op">-</span><span class="st"> </span>College<span class="op">$</span>Apps[test])<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 1695269</code></pre>
<blockquote>
<ol start="6" style="list-style-type: lower-alpha">
<li>Fit a PLS model on the training set, with <span class="math inline">\(M\)</span> chosen by cross-validation.
Report the test error obtained, along with the value of <span class="math inline">\(M\)</span> selected by
cross-validation.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="linear-model-selection-and-regularization.html#cb366-1"></a>fit5 &lt;-<span class="st"> </span><span class="kw">plsr</span>(Apps <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> College[train, ], <span class="dt">scale =</span> <span class="ot">TRUE</span>, <span class="dt">validation =</span> <span class="st">&quot;CV&quot;</span>)</span>
<span id="cb366-2"><a href="linear-model-selection-and-regularization.html#cb366-2"></a><span class="kw">validationplot</span>(fit5, <span class="dt">val.type =</span> <span class="st">&quot;MSEP&quot;</span>)</span></code></pre></div>
<p><img src="06-linear-model-selection-and-regularization_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="linear-model-selection-and-regularization.html#cb367-1"></a>p &lt;-<span class="st"> </span><span class="kw">predict</span>(fit5, College[test, ], <span class="dt">ncomp =</span> <span class="dv">12</span>)</span>
<span id="cb367-2"><a href="linear-model-selection-and-regularization.html#cb367-2"></a>(mse<span class="op">$</span>pls &lt;-<span class="st"> </span><span class="kw">mean</span>((p <span class="op">-</span><span class="st"> </span>College<span class="op">$</span>Apps[test])<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 1696902</code></pre>
<blockquote>
<ol start="7" style="list-style-type: lower-alpha">
<li>Comment on the results obtained. How accurately can we predict the number
of college applications received? Is there much difference among the test
errors resulting from these five approaches?</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="linear-model-selection-and-regularization.html#cb369-1"></a><span class="kw">barplot</span>(<span class="kw">unlist</span>(mse), <span class="dt">ylab =</span> <span class="st">&quot;Test MSE&quot;</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="06-linear-model-selection-and-regularization_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Ridge and lasso give the lowest test errors but the lowest is generated by
the ridge regression model (in this specific case with this specific seed).</p>
</div>
<div id="question-10-3" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.2.3</span> Question 10<a href="linear-model-selection-and-regularization.html#question-10-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>We have seen that as the number of features used in a model increases, the
training error will necessarily decrease, but the test error may not. We will
now explore this in a simulated data set.</p>
<ol style="list-style-type: lower-alpha">
<li>Generate a data set with <span class="math inline">\(p = 20\)</span> features, <span class="math inline">\(n = 1,000\)</span> observations, and
an associated quantitative response vector generated according to the model
<span class="math inline">\(Y =X\beta + \epsilon\)</span>, where <span class="math inline">\(\beta\)</span> has some elements that are exactly
equal to zero.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="linear-model-selection-and-regularization.html#cb370-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb370-2"><a href="linear-model-selection-and-regularization.html#cb370-2"></a>dat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">1000</span><span class="op">*</span><span class="dv">20</span>), <span class="dt">nrow =</span> <span class="dv">1000</span>)</span>
<span id="cb370-3"><a href="linear-model-selection-and-regularization.html#cb370-3"></a><span class="kw">colnames</span>(dat) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;b&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>)</span>
<span id="cb370-4"><a href="linear-model-selection-and-regularization.html#cb370-4"></a>beta &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">20</span>)</span>
<span id="cb370-5"><a href="linear-model-selection-and-regularization.html#cb370-5"></a>beta[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">7</span>)</span>
<span id="cb370-6"><a href="linear-model-selection-and-regularization.html#cb370-6"></a>y &lt;-<span class="st"> </span><span class="kw">colSums</span>((<span class="kw">t</span>(dat) <span class="op">*</span><span class="st"> </span>beta)) <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb370-7"><a href="linear-model-selection-and-regularization.html#cb370-7"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(dat)</span>
<span id="cb370-8"><a href="linear-model-selection-and-regularization.html#cb370-8"></a>dat<span class="op">$</span>y &lt;-<span class="st"> </span>y</span></code></pre></div>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Split your data set into a training set containing 100 observations and a
test set containing 900 observations.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="linear-model-selection-and-regularization.html#cb371-1"></a>train &lt;-<span class="st"> </span>dat[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, ]</span>
<span id="cb371-2"><a href="linear-model-selection-and-regularization.html#cb371-2"></a>test &lt;-<span class="st"> </span>dat[<span class="dv">101</span><span class="op">:</span><span class="dv">1000</span>, ]</span></code></pre></div>
<blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>Perform best subset selection on the training set, and plot the training
set MSE associated with the best model of each size.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="linear-model-selection-and-regularization.html#cb372-1"></a>fit &lt;-<span class="st"> </span><span class="kw">regsubsets</span>(y <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> train, <span class="dt">nvmax =</span> <span class="dv">20</span>)</span>
<span id="cb372-2"><a href="linear-model-selection-and-regularization.html#cb372-2"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre><code>## Subset selection object
## Call: regsubsets.formula(y ~ ., data = train, nvmax = 20)
## 20 Variables  (and intercept)
##     Forced in Forced out
## b1      FALSE      FALSE
## b2      FALSE      FALSE
## b3      FALSE      FALSE
## b4      FALSE      FALSE
## b5      FALSE      FALSE
## b6      FALSE      FALSE
## b7      FALSE      FALSE
## b8      FALSE      FALSE
## b9      FALSE      FALSE
## b10     FALSE      FALSE
## b11     FALSE      FALSE
## b12     FALSE      FALSE
## b13     FALSE      FALSE
## b14     FALSE      FALSE
## b15     FALSE      FALSE
## b16     FALSE      FALSE
## b17     FALSE      FALSE
## b18     FALSE      FALSE
## b19     FALSE      FALSE
## b20     FALSE      FALSE
## 1 subsets of each size up to 20
## Selection Algorithm: exhaustive
##           b1  b2  b3  b4  b5  b6  b7  b8  b9  b10 b11 b12 b13 b14 b15 b16 b17
## 1  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;
## 2  ( 1 )  &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;
## 3  ( 1 )  &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;
## 4  ( 1 )  &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;
## 5  ( 1 )  &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;
## 6  ( 1 )  &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot;
## 7  ( 1 )  &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot;
## 8  ( 1 )  &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot;
## 9  ( 1 )  &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot;
## 10  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot;
## 11  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot;
## 12  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot;
## 13  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot;
## 14  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot;
## 15  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot;
## 16  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot;
## 17  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot;
## 18  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot;
## 19  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot;
## 20  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot;
##           b18 b19 b20
## 1  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 2  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 3  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 4  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 5  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 6  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 7  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 8  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 9  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 10  ( 1 ) &quot; &quot; &quot; &quot; &quot;*&quot;
## 11  ( 1 ) &quot; &quot; &quot; &quot; &quot;*&quot;
## 12  ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot;
## 13  ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot;
## 14  ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot;
## 15  ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot;
## 16  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot;
## 17  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot;
## 18  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot;
## 19  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot;
## 20  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot;</code></pre>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="linear-model-selection-and-regularization.html#cb374-1"></a><span class="kw">plot</span>(<span class="kw">summary</span>(fit)<span class="op">$</span>rss <span class="op">/</span><span class="st"> </span><span class="dv">100</span>, <span class="dt">ylab =</span> <span class="st">&quot;MSE&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>)</span></code></pre></div>
<p><img src="06-linear-model-selection-and-regularization_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<blockquote>
<ol start="4" style="list-style-type: lower-alpha">
<li>Plot the test set MSE associated with the best model of each size.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="linear-model-selection-and-regularization.html#cb375-1"></a>predict.regsubsets &lt;-<span class="st"> </span><span class="cf">function</span> (object, newdata, id, ...) {</span>
<span id="cb375-2"><a href="linear-model-selection-and-regularization.html#cb375-2"></a>  form &lt;-<span class="st"> </span><span class="kw">as.formula</span> (object<span class="op">$</span>call[[<span class="dv">2</span>]])</span>
<span id="cb375-3"><a href="linear-model-selection-and-regularization.html#cb375-3"></a>  mat &lt;-<span class="st"> </span><span class="kw">model.matrix</span> (form , newdata)</span>
<span id="cb375-4"><a href="linear-model-selection-and-regularization.html#cb375-4"></a>  coefi &lt;-<span class="st"> </span><span class="kw">coef</span>(object, <span class="dt">id =</span> id)</span>
<span id="cb375-5"><a href="linear-model-selection-and-regularization.html#cb375-5"></a>  xvars &lt;-<span class="st"> </span><span class="kw">names</span>(coefi)</span>
<span id="cb375-6"><a href="linear-model-selection-and-regularization.html#cb375-6"></a>  mat[ ,xvars] <span class="op">%*%</span><span class="st"> </span>coefi</span>
<span id="cb375-7"><a href="linear-model-selection-and-regularization.html#cb375-7"></a>}</span>
<span id="cb375-8"><a href="linear-model-selection-and-regularization.html#cb375-8"></a>mse &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="cf">function</span>(i) <span class="kw">mean</span>((test<span class="op">$</span>y <span class="op">-</span><span class="st"> </span><span class="kw">predict</span>(fit, test, i))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb375-9"><a href="linear-model-selection-and-regularization.html#cb375-9"></a><span class="kw">plot</span>(mse, <span class="dt">ylab =</span> <span class="st">&quot;MSE&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<p><img src="06-linear-model-selection-and-regularization_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<blockquote>
<ol start="5" style="list-style-type: lower-alpha">
<li>For which model size does the test set MSE take on its minimum value?
Comment on your results. If it takes on its minimum value for a model
containing only an intercept or a model containing all of the features,
then play around with the way that you are generating the data in (a) until
you come up with a scenario in which the test set MSE is minimized for an
intermediate model size.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="linear-model-selection-and-regularization.html#cb376-1"></a><span class="kw">which.min</span>(mse)</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>The min test MSE is found when model size is 4. This corresponds to the
simulated data which has four non-zero coefficients.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="linear-model-selection-and-regularization.html#cb378-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb378-2"><a href="linear-model-selection-and-regularization.html#cb378-2"></a>dat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">1000</span><span class="op">*</span><span class="dv">20</span>), <span class="dt">nrow =</span> <span class="dv">1000</span>)</span>
<span id="cb378-3"><a href="linear-model-selection-and-regularization.html#cb378-3"></a><span class="kw">colnames</span>(dat) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;b&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>)</span>
<span id="cb378-4"><a href="linear-model-selection-and-regularization.html#cb378-4"></a>beta &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">20</span>)</span>
<span id="cb378-5"><a href="linear-model-selection-and-regularization.html#cb378-5"></a>beta[<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">7</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>)</span>
<span id="cb378-6"><a href="linear-model-selection-and-regularization.html#cb378-6"></a>y &lt;-<span class="st"> </span><span class="kw">colSums</span>((<span class="kw">t</span>(dat) <span class="op">*</span><span class="st"> </span>beta)) <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb378-7"><a href="linear-model-selection-and-regularization.html#cb378-7"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(dat)</span>
<span id="cb378-8"><a href="linear-model-selection-and-regularization.html#cb378-8"></a>dat<span class="op">$</span>y &lt;-<span class="st"> </span>y</span>
<span id="cb378-9"><a href="linear-model-selection-and-regularization.html#cb378-9"></a>train &lt;-<span class="st"> </span>dat[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, ]</span>
<span id="cb378-10"><a href="linear-model-selection-and-regularization.html#cb378-10"></a>test &lt;-<span class="st"> </span>dat[<span class="dv">101</span><span class="op">:</span><span class="dv">1000</span>, ]</span>
<span id="cb378-11"><a href="linear-model-selection-and-regularization.html#cb378-11"></a></span>
<span id="cb378-12"><a href="linear-model-selection-and-regularization.html#cb378-12"></a>fit &lt;-<span class="st"> </span><span class="kw">regsubsets</span>(y <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> train, <span class="dt">nvmax =</span> <span class="dv">20</span>)</span>
<span id="cb378-13"><a href="linear-model-selection-and-regularization.html#cb378-13"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre><code>## Subset selection object
## Call: regsubsets.formula(y ~ ., data = train, nvmax = 20)
## 20 Variables  (and intercept)
##     Forced in Forced out
## b1      FALSE      FALSE
## b2      FALSE      FALSE
## b3      FALSE      FALSE
## b4      FALSE      FALSE
## b5      FALSE      FALSE
## b6      FALSE      FALSE
## b7      FALSE      FALSE
## b8      FALSE      FALSE
## b9      FALSE      FALSE
## b10     FALSE      FALSE
## b11     FALSE      FALSE
## b12     FALSE      FALSE
## b13     FALSE      FALSE
## b14     FALSE      FALSE
## b15     FALSE      FALSE
## b16     FALSE      FALSE
## b17     FALSE      FALSE
## b18     FALSE      FALSE
## b19     FALSE      FALSE
## b20     FALSE      FALSE
## 1 subsets of each size up to 20
## Selection Algorithm: exhaustive
##           b1  b2  b3  b4  b5  b6  b7  b8  b9  b10 b11 b12 b13 b14 b15 b16 b17
## 1  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;
## 2  ( 1 )  &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;
## 3  ( 1 )  &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;
## 4  ( 1 )  &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;
## 5  ( 1 )  &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;
## 6  ( 1 )  &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot;
## 7  ( 1 )  &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot;
## 8  ( 1 )  &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot;
## 9  ( 1 )  &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot;
## 10  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot;
## 11  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot;
## 12  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot;
## 13  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot;
## 14  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot;
## 15  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot;
## 16  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot;
## 17  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot;
## 18  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot;
## 19  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot;
## 20  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot;
##           b18 b19 b20
## 1  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 2  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 3  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 4  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 5  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 6  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 7  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 8  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 9  ( 1 )  &quot; &quot; &quot; &quot; &quot; &quot;
## 10  ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot;
## 11  ( 1 ) &quot; &quot; &quot; &quot; &quot;*&quot;
## 12  ( 1 ) &quot; &quot; &quot; &quot; &quot;*&quot;
## 13  ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot;
## 14  ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot;
## 15  ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot;
## 16  ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot;
## 17  ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot;
## 18  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot;
## 19  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot;
## 20  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot;</code></pre>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="linear-model-selection-and-regularization.html#cb380-1"></a>mse &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="cf">function</span>(i) <span class="kw">mean</span>((test<span class="op">$</span>y <span class="op">-</span><span class="st"> </span><span class="kw">predict</span>(fit, test, i))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb380-2"><a href="linear-model-selection-and-regularization.html#cb380-2"></a><span class="kw">plot</span>(mse, <span class="dt">ylab =</span> <span class="st">&quot;MSE&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<p><img src="06-linear-model-selection-and-regularization_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="linear-model-selection-and-regularization.html#cb381-1"></a><span class="kw">which.min</span>(mse)</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<blockquote>
<ol start="6" style="list-style-type: lower-alpha">
<li>How does the model at which the test set MSE is minimized compare to the
true model used to generate the data? Comment on the coefficient values.</li>
</ol>
</blockquote>
<p>The min test MSE is found when model size is 5 but there are 9 non-zero
coefficients.</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="linear-model-selection-and-regularization.html#cb383-1"></a><span class="kw">coef</span>(fit, <span class="dt">id =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## (Intercept)          b1          b2          b3          b4          b9 
##  0.03507654  5.06180121  3.82785027  2.20434996  7.05312844  0.57032008</code></pre>
<p>The coefficient values are well estimated when high, but the smaller
coefficients are dropped.</p>
<blockquote>
<ol start="7" style="list-style-type: lower-alpha">
<li>Create a plot displaying <span class="math inline">\(\sqrt{\sum_{j=1}^p (\beta_j - \hat{\beta}{}_j^r)^2}\)</span>
for a range of values of <span class="math inline">\(r\)</span>, where <span class="math inline">\(\hat{\beta}{}_j^r\)</span> is the <span class="math inline">\(j\)</span>th
coefficient estimate for the best model containing <span class="math inline">\(r\)</span> coefficients. Comment
on what you observe. How does this compare to the test MSE plot from (d)?</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="linear-model-selection-and-regularization.html#cb385-1"></a><span class="kw">names</span>(beta) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;b&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>)</span>
<span id="cb385-2"><a href="linear-model-selection-and-regularization.html#cb385-2"></a>b &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id =</span> <span class="kw">names</span>(beta), <span class="dt">b =</span> beta)</span>
<span id="cb385-3"><a href="linear-model-selection-and-regularization.html#cb385-3"></a></span>
<span id="cb385-4"><a href="linear-model-selection-and-regularization.html#cb385-4"></a>out &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="cf">function</span>(i) {</span>
<span id="cb385-5"><a href="linear-model-selection-and-regularization.html#cb385-5"></a>  c &lt;-<span class="st"> </span><span class="kw">coef</span>(fit, <span class="dt">id =</span> i)[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb385-6"><a href="linear-model-selection-and-regularization.html#cb385-6"></a>  c &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id =</span> <span class="kw">names</span>(c), <span class="dt">c =</span> c)</span>
<span id="cb385-7"><a href="linear-model-selection-and-regularization.html#cb385-7"></a>  m &lt;-<span class="st"> </span><span class="kw">merge</span>(b, c)</span>
<span id="cb385-8"><a href="linear-model-selection-and-regularization.html#cb385-8"></a>  <span class="kw">sqrt</span>(<span class="kw">sum</span>((m<span class="op">$</span>b <span class="op">-</span><span class="st"> </span>m<span class="op">$</span>c)<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb385-9"><a href="linear-model-selection-and-regularization.html#cb385-9"></a>})</span>
<span id="cb385-10"><a href="linear-model-selection-and-regularization.html#cb385-10"></a><span class="kw">plot</span>(out, <span class="dt">ylab =</span> <span class="st">&quot;Mean squared coefficient error&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<p><img src="06-linear-model-selection-and-regularization_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>The error of the coefficient estimates is minimized when model size is 5. This
corresponds to the point when test MSE was minimized.</p>
</div>
<div id="question-11-2" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.2.4</span> Question 11<a href="linear-model-selection-and-regularization.html#question-11-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>We will now try to predict per capita crime rate in the <code>Boston</code> data set.</p>
<ol style="list-style-type: lower-alpha">
<li>Try out some of the regression methods explored in this chapter, such as
best subset selection, the lasso, ridge regression, and PCR. Present and
discuss results for the approaches that you consider.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="linear-model-selection-and-regularization.html#cb386-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb386-2"><a href="linear-model-selection-and-regularization.html#cb386-2"></a>train &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">nrow</span>(Boston), <span class="kw">nrow</span>(Boston)<span class="op">*</span><span class="dv">2</span><span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb386-3"><a href="linear-model-selection-and-regularization.html#cb386-3"></a>test &lt;-<span class="st"> </span><span class="kw">setdiff</span>(<span class="kw">seq_len</span>(<span class="kw">nrow</span>(Boston)), train)</span>
<span id="cb386-4"><a href="linear-model-selection-and-regularization.html#cb386-4"></a><span class="kw">hist</span>(<span class="kw">log</span>(Boston<span class="op">$</span>crim))</span></code></pre></div>
<p><img src="06-linear-model-selection-and-regularization_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<blockquote>
<ol start="2" style="list-style-type: lower-alpha">
<li>Propose a model (or set of models) that seem to perform well on this data
set, and justify your answer. Make sure that you are evaluating model
performance using validation set error, cross-validation, or some other
reasonable alternative, as opposed to using training error.</li>
</ol>
</blockquote>
<p>We will try to fit models to <code>log(Boston$crim)</code> which is closer to a normal
distribution.</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="linear-model-selection-and-regularization.html#cb387-1"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(crim) <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> Boston[train, ])</span>
<span id="cb387-2"><a href="linear-model-selection-and-regularization.html#cb387-2"></a><span class="kw">mean</span>((<span class="kw">predict</span>(fit, Boston[test, ]) <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(Boston<span class="op">$</span>crim[test])) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.66578</code></pre>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="linear-model-selection-and-regularization.html#cb389-1"></a>mm &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="kw">log</span>(crim) <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> Boston[train, ])</span>
<span id="cb389-2"><a href="linear-model-selection-and-regularization.html#cb389-2"></a>fit2 &lt;-<span class="st"> </span><span class="kw">cv.glmnet</span>(mm, <span class="kw">log</span>(Boston<span class="op">$</span>crim[train]), <span class="dt">alpha =</span> <span class="dv">0</span>)</span>
<span id="cb389-3"><a href="linear-model-selection-and-regularization.html#cb389-3"></a>p &lt;-<span class="st"> </span><span class="kw">predict</span>(fit2, <span class="kw">model.matrix</span>(<span class="kw">log</span>(crim) <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> Boston[test, ]), <span class="dt">s =</span> fit2<span class="op">$</span>lambda.min)</span>
<span id="cb389-4"><a href="linear-model-selection-and-regularization.html#cb389-4"></a><span class="kw">mean</span>((p <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(Boston<span class="op">$</span>crim[test])) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.6511807</code></pre>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="linear-model-selection-and-regularization.html#cb391-1"></a>mm &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="kw">log</span>(crim) <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> Boston[train, ])</span>
<span id="cb391-2"><a href="linear-model-selection-and-regularization.html#cb391-2"></a>fit3 &lt;-<span class="st"> </span><span class="kw">cv.glmnet</span>(mm, <span class="kw">log</span>(Boston<span class="op">$</span>crim[train]), <span class="dt">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb391-3"><a href="linear-model-selection-and-regularization.html#cb391-3"></a>p &lt;-<span class="st"> </span><span class="kw">predict</span>(fit3, <span class="kw">model.matrix</span>(<span class="kw">log</span>(crim) <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> Boston[test, ]), <span class="dt">s =</span> fit3<span class="op">$</span>lambda.min)</span>
<span id="cb391-4"><a href="linear-model-selection-and-regularization.html#cb391-4"></a><span class="kw">mean</span>((p <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(Boston<span class="op">$</span>crim[test])) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.6494337</code></pre>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="linear-model-selection-and-regularization.html#cb393-1"></a>fit4 &lt;-<span class="st"> </span><span class="kw">pcr</span>(<span class="kw">log</span>(crim) <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> Boston[train, ], <span class="dt">scale =</span> <span class="ot">TRUE</span>, <span class="dt">validation =</span> <span class="st">&quot;CV&quot;</span>)</span>
<span id="cb393-2"><a href="linear-model-selection-and-regularization.html#cb393-2"></a><span class="kw">validationplot</span>(fit4, <span class="dt">val.type =</span> <span class="st">&quot;MSEP&quot;</span>)</span></code></pre></div>
<p><img src="06-linear-model-selection-and-regularization_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="linear-model-selection-and-regularization.html#cb394-1"></a>p &lt;-<span class="st"> </span><span class="kw">predict</span>(fit4, Boston[test, ], <span class="dt">ncomp =</span> <span class="dv">8</span>)</span>
<span id="cb394-2"><a href="linear-model-selection-and-regularization.html#cb394-2"></a><span class="kw">mean</span>((p <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(Boston<span class="op">$</span>crim[test]))<span class="op">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.6561043</code></pre>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="linear-model-selection-and-regularization.html#cb396-1"></a>fit5 &lt;-<span class="st"> </span><span class="kw">plsr</span>(<span class="kw">log</span>(crim) <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> Boston[train, ], <span class="dt">scale =</span> <span class="ot">TRUE</span>, <span class="dt">validation =</span> <span class="st">&quot;CV&quot;</span>)</span>
<span id="cb396-2"><a href="linear-model-selection-and-regularization.html#cb396-2"></a><span class="kw">validationplot</span>(fit5, <span class="dt">val.type =</span> <span class="st">&quot;MSEP&quot;</span>)</span></code></pre></div>
<p><img src="06-linear-model-selection-and-regularization_files/figure-html/unnamed-chunk-26-2.png" width="672" /></p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="linear-model-selection-and-regularization.html#cb397-1"></a>p &lt;-<span class="st"> </span><span class="kw">predict</span>(fit5, Boston[test, ], <span class="dt">ncomp =</span> <span class="dv">6</span>)</span>
<span id="cb397-2"><a href="linear-model-selection-and-regularization.html#cb397-2"></a><span class="kw">mean</span>((p <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(Boston<span class="op">$</span>crim[test]))<span class="op">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.6773353</code></pre>
<p>In this case lasso (<code>alpha = 1</code>) seems to perform very slightly better than
un-penalized regression. Some coefficients have been dropped:</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="linear-model-selection-and-regularization.html#cb399-1"></a><span class="kw">coef</span>(fit3, <span class="dt">s =</span> fit3<span class="op">$</span>lambda.min)</span></code></pre></div>
<pre><code>## 14 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
##                       s1
## (Intercept) -4.713172675
## (Intercept)  .          
## zn          -0.011043739
## indus        0.022515402
## chas         .          
## nox          3.856157215
## rm           .          
## age          0.004210529
## dis          .          
## rad          0.145604750
## tax          .          
## ptratio     -0.031787696
## lstat        0.036112321
## medv         0.004304181</code></pre>
<blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>Does your chosen model involve all of the features in the data set? Why or
why not?</li>
</ol>
</blockquote>
<p>Not all features are included due to the lasso penalization.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="resampling-methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="moving-beyond-linearity.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/danhalligan/ISLRv2-solutions/edit/master/06-linear-model-selection-and-regularization.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
